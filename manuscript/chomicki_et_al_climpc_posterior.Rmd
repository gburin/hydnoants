---
author: Guillaume Chomicki1*, Gustavo Burin2, Toby ??, Susanne S. Renner3
title: The effects of mutualism on trait evolution - Residuals from ClimPC - Posterior distribution of trees
output:
  pdf_document:
    toc: true
    latex_engine: lualatex
    keep_tex: true
  html_document:
    toc: true
    toc_float: true
header-includes:
  - \usepackage{pdflscape}
classoption: 
  - table
  - dvipsnames
---

Submitted to Ecology Letters, Evolution or Evolution Letters – well let’s see what we find!

Affiliations: 1Department of Bioscience, Durham University, Stockton Rd., Durham DH1 3LE, UK. 2University of Sao Paulo, xxxxx. 3Systematic Botany and Mycology, Department of Biology, University of Munich (LMU), Menzinger Str. 67, 80638 Munich, Germany.

Correspondence: *guillaume.chomicki@durham.ac.uk

# Analyses accounting for climate

The results below follow the same rationale as the ones from the main document. However, in the cases below all analyses use the plant traits already accounted for climatic effects by using the residuals from the regressions between each trait and the first three Principal Components of the climatic variables obtained from BioClim (REF).

\newpage

# Methods

```{r setup, eval = TRUE, echo = FALSE}

here::i_am("manuscript/chomicki_et_al_climpc_posterior.Rmd")

## options(kableExtra.latex.load_packages = FALSE)

#source(here::here("R/tree_plots.R"))
library("knitr")
library("RColorBrewer")
library("kableExtra")
library("ggplot2")
library("tidyverse")
# load("../output/first_analysis.RData")
knitr::opts_chunk$set(fig.pos = "h", out.extra = "")
# source("../R/ouwie_summary_mcc.R")
pars.table.pc1 <- read.csv(here::here("output/fullpar_table_climpc1_posterior.csv"))
pars.table.pc1$trait <- c("Stem Area", "Leaf Area", "Corola Length", "Petiole Length", "Hole Diameter")[match(pars.table.pc1$trait, c("stemarea", "leafarea", "corleng", "petleng", "holediam"))]
pars.table.pc1.clean <- pars.table.pc1[apply(pars.table.pc1[, grep("theta", names(pars.table.pc1))], 1, function(x){!any(x > 15, na.rm = TRUE)}),]
pars.table.pc1.clean <- pars.table.pc1.clean[apply(pars.table.pc1.clean[, grep("theta", names(pars.table.pc1.clean))], 1, function(x){!any(x < -15, na.rm = TRUE)}),]
pars.table.pc1 <- pars.table.pc1.clean

pars.table.pc2 <- read.csv(here::here("output/fullpar_table_climpc2_posterior.csv"))
pars.table.pc2$trait <- c("Stem Area", "Leaf Area", "Corola Length", "Petiole Lengzth", "Hole Diameter")[match(pars.table.pc2$trait, c("stemarea", "leafarea", "corleng", "petleng", "holediam"))]
pars.table.pc2.clean <- pars.table.pc2[apply(pars.table.pc2[, grep("theta", names(pars.table.pc2))], 1, function(x){!any(x > 15, na.rm = TRUE)}),]
pars.table.pc2.clean <- pars.table.pc2.clean[apply(pars.table.pc2.clean[, grep("theta", names(pars.table.pc2.clean))], 1, function(x){!any(x < -15, na.rm = TRUE)}),]
pars.table.pc2 <- pars.table.pc2.clean

pars.table.pc3 <- read.csv(here::here("output/fullpar_table_climpc3_posterior.csv"))
pars.table.pc3$trait <- c("Stem Area", "Leaf Area", "Corola Length", "Petiole Length", "Hole Diameter")[match(pars.table.pc3$trait, c("stemarea", "leafarea", "corleng", "petleng", "holediam"))]
pars.table.pc3.clean <- pars.table.pc3[apply(pars.table.pc3[, grep("theta", names(pars.table.pc3))], 1, function(x){!any(x > 15, na.rm = TRUE)}),]
pars.table.pc3.clean <- pars.table.pc3.clean[apply(pars.table.pc3.clean[, grep("theta", names(pars.table.pc3.clean))], 1, function(x){!any(x < -15, na.rm = TRUE)}),]
pars.table.pc3 <- pars.table.pc3.clean

colors <- setNames(brewer.pal(4, "Set1"), 1:4)
sig.formatter <- function(x){cell_spec(x, format = "latex", bold = ifelse(x > 100, TRUE, FALSE), background = if(x >= 150){"ForestGreen"} else if(x < 150 & x >= 125){"Peach"} else if(x < 125 & x >= 100){"Goldenrod"})}

```

# Figures and tables

```{r pars_ouwie_setup, echo = FALSE, message = FALSE, warning = FALSE}

library("cowplot")
library("patchwork")

data.plot.pc1 <- reshape2::melt(pars.table.pc1, id.vars = c("trait", "disc.trait", "simmap", "tree"))
theta.plot.pc1 <- data.plot.pc1[grep("theta", data.plot.pc1$variable),]
alpha.plot.pc1 <- data.plot.pc1[grep("alpha", data.plot.pc1$variable),]
sigma.plot.pc1 <- data.plot.pc1[grep("sigma", data.plot.pc1$variable),]

data.plot.pc2 <- reshape2::melt(pars.table.pc2, id.vars = c("trait", "disc.trait", "simmap", "tree"))
theta.plot.pc2 <- data.plot.pc2[grep("theta", data.plot.pc2$variable),]
alpha.plot.pc2 <- data.plot.pc2[grep("alpha", data.plot.pc2$variable),]
sigma.plot.pc2 <- data.plot.pc2[grep("sigma", data.plot.pc2$variable),]

data.plot.pc3 <- reshape2::melt(pars.table.pc3, id.vars = c("trait", "disc.trait", "simmap", "tree"))
theta.plot.pc3 <- data.plot.pc3[grep("theta", data.plot.pc3$variable),]
alpha.plot.pc3 <- data.plot.pc3[grep("alpha", data.plot.pc3$variable),]
sigma.plot.pc3 <- data.plot.pc3[grep("sigma", data.plot.pc3$variable),]

states.app <- c(#"outgroup",
                "none",
                "variable",
                "spines")
states.arch <- c(#"shrub",
                 "multiple",
                 "single")
states.domgrow <- c(#"outgroup",
                    "diffuse",
                    "apical")
states.leafstruc <- c("thick",
                      "var",
                      "thin",
                      "succ")
states.matsys <- c("het",
                   "nonHet",
                   "unisex")
states.reward <- c(#"outgroup",
                   "absent",
                   "present")
states.strategy <- c(#"outgroup",
                     "facult",
                     "oblig",
                     "lost")
states.warts <- c(#"outgroup",
                  "variable",
                  "diff",
                  "lost")
states.holediam.disc <- c(#"absent",
                          "sevLbase",
                          "oneLbase",
                          "allL")

source(here::here("R/data_prep_ouwie_climpc_posterior.R"))

```

# Appendages

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```
	
```{r pars_ouwie_app_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.app)), rep(1:length(states.app), 3))

theta.app.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "app")
theta.app.plot.pc1$variable <- as.character(theta.app.plot.pc1$variable)
theta.app.plot.pc1 <- theta.app.plot.pc1[theta.app.plot.pc1$variable %in% paste0("theta", 1:length(states.app)),]

alpha.app.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "app")
alpha.app.plot.pc1$variable <- as.character(alpha.app.plot.pc1$variable)
alpha.app.plot.pc1 <- alpha.app.plot.pc1[alpha.app.plot.pc1$variable %in% paste0("alpha", 1:length(states.app)),]

sigma.app.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "app")
sigma.app.plot.pc1$variable <- as.character(sigma.app.plot.pc1$variable)
sigma.app.plot.pc1 <- sigma.app.plot.pc1[sigma.app.plot.pc1$variable %in% paste0("sigma", 1:length(states.app)),]

theta.app.pc1 <-
    ggplot(na.omit(theta.app.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.app.pc1 <-
    ggplot(na.omit(alpha.app.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.app.pc1 <-
    ggplot(na.omit(sigma.app.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.app.pc1 + alpha.app.pc1 + sigma.app.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_app_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.theta.pc1.", gsub(" ", ".", agg.app.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_app_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.alpha.pc1.", gsub(" ", ".", agg.app.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_app_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.sigma.pc1.", gsub(" ", ".", agg.app.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_app_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.app)), rep(1:length(states.app), 3))

theta.app.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "app")
theta.app.plot.pc2 <- theta.app.plot.pc2[theta.app.plot.pc2$variable %in% filter.pars,]
theta.app.plot.pc2$variable <- as.character(theta.app.plot.pc2$variable)
theta.app.plot.pc2 <- theta.app.plot.pc2[!is.na(theta.app.plot.pc2$value),]
theta.app.plot.pc2 <- theta.app.plot.pc2[theta.app.plot.pc2$value >= -10 & theta.app.plot.pc2$value <= 10, ]

alpha.app.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "app")
alpha.app.plot.pc2 <- alpha.app.plot.pc2[alpha.app.plot.pc2$variable %in% filter.pars,]
alpha.app.plot.pc2$variable <- as.character(alpha.app.plot.pc2$variable)
alpha.app.plot.pc2 <- alpha.app.plot.pc2[!is.na(alpha.app.plot.pc2$value),]
alpha.app.plot.pc2 <- alpha.app.plot.pc2[alpha.app.plot.pc2$value >= -10 & alpha.app.plot.pc2$value <= 10, ]

sigma.app.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "app")
sigma.app.plot.pc2 <- sigma.app.plot.pc2[sigma.app.plot.pc2$variable %in% filter.pars,]
sigma.app.plot.pc2$variable <- as.character(sigma.app.plot.pc2$variable)
sigma.app.plot.pc2 <- sigma.app.plot.pc2[!is.na(sigma.app.plot.pc2$value),]
sigma.app.plot.pc2 <- sigma.app.plot.pc2[sigma.app.plot.pc2$value >= -10 & sigma.app.plot.pc2$value <= 10, ]

theta.app.pc2 <-
    ggplot(na.omit(theta.app.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.app.pc2 <-
    ggplot(na.omit(alpha.app.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.app.pc2 <-
    ggplot(na.omit(sigma.app.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.app.pc2 + alpha.app.pc2 + sigma.app.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_app_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.theta.pc2.", gsub(" ", ".", agg.app.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_app_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.alpha.pc2.", gsub(" ", ".", agg.app.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_app_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.sigma.pc2.", gsub(" ", ".", agg.app.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_app_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.app)), rep(1:length(states.app), 3))

theta.app.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "app")
theta.app.plot.pc3 <- theta.app.plot.pc3[theta.app.plot.pc3$variable %in% filter.pars,]
theta.app.plot.pc3$variable <- as.character(theta.app.plot.pc3$variable)
theta.app.plot.pc3 <- theta.app.plot.pc3[!is.na(theta.app.plot.pc3$value),]
theta.app.plot.pc3 <- theta.app.plot.pc3[theta.app.plot.pc3$value >= -10 & theta.app.plot.pc3$value <= 10, ]

alpha.app.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "app")
alpha.app.plot.pc3 <- alpha.app.plot.pc3[alpha.app.plot.pc3$variable %in% filter.pars,]
alpha.app.plot.pc3$variable <- as.character(alpha.app.plot.pc3$variable)
alpha.app.plot.pc3 <- alpha.app.plot.pc3[!is.na(alpha.app.plot.pc3$value),]
alpha.app.plot.pc3 <- alpha.app.plot.pc3[alpha.app.plot.pc3$value >= -10 & alpha.app.plot.pc3$value <= 10, ]

sigma.app.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "app")
sigma.app.plot.pc3 <- sigma.app.plot.pc3[sigma.app.plot.pc3$variable %in% filter.pars,]
sigma.app.plot.pc3$variable <- as.character(sigma.app.plot.pc3$variable)
sigma.app.plot.pc3 <- sigma.app.plot.pc3[!is.na(sigma.app.plot.pc3$value),]
sigma.app.plot.pc3 <- sigma.app.plot.pc3[sigma.app.plot.pc3$value >= -10 & sigma.app.plot.pc3$value <= 10, ]

theta.app.pc3 <-
    ggplot(na.omit(theta.app.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.app.pc3 <-
    ggplot(na.omit(alpha.app.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.app.pc3 <-
    ggplot(na.omit(sigma.app.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.app.pc3 + alpha.app.pc3 + sigma.app.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_app_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.theta.pc3.", gsub(" ", ".", agg.app.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))
```

```{r diffs_alpha_ouwie_app_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.alpha.pc3.", gsub(" ", ".", agg.app.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_app_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.sigma.pc3.", gsub(" ", ".", agg.app.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```






# Architecture

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_arch_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.arch)), rep(1:length(states.arch), 3))

theta.arch.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "arch")
theta.arch.plot.pc1 <- theta.arch.plot.pc1[theta.arch.plot.pc1$variable %in% filter.pars,]
theta.arch.plot.pc1$variable <- as.character(theta.arch.plot.pc1$variable)
theta.arch.plot.pc1 <- theta.arch.plot.pc1[!is.na(theta.arch.plot.pc1$value),]
theta.arch.plot.pc1 <- theta.arch.plot.pc1[theta.arch.plot.pc1$value >= -10 & theta.arch.plot.pc1$value <= 10, ]

alpha.arch.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "arch")
alpha.arch.plot.pc1 <- alpha.arch.plot.pc1[alpha.arch.plot.pc1$variable %in% filter.pars,]
alpha.arch.plot.pc1$variable <- as.character(alpha.arch.plot.pc1$variable)
alpha.arch.plot.pc1 <- alpha.arch.plot.pc1[!is.na(alpha.arch.plot.pc1$value),]
alpha.arch.plot.pc1 <- alpha.arch.plot.pc1[alpha.arch.plot.pc1$value >= -10 & alpha.arch.plot.pc1$value <= 10, ]

sigma.arch.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "arch")
sigma.arch.plot.pc1 <- sigma.arch.plot.pc1[sigma.arch.plot.pc1$variable %in% filter.pars,]
sigma.arch.plot.pc1$variable <- as.character(sigma.arch.plot.pc1$variable)
sigma.arch.plot.pc1 <- sigma.arch.plot.pc1[!is.na(sigma.arch.plot.pc1$value),]
sigma.arch.plot.pc1 <- sigma.arch.plot.pc1[sigma.arch.plot.pc1$value >= -10 & sigma.arch.plot.pc1$value <= 10, ]

theta.arch.pc1 <-
    ggplot(na.omit(theta.arch.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.arch.pc1 <-
    ggplot(na.omit(alpha.arch.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.arch.pc1 <-
    ggplot(na.omit(sigma.arch.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.arch.pc1 + alpha.arch.pc1 + sigma.arch.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_arch_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.theta.pc1.", gsub(" ", ".", agg.arch.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_arch_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.alpha.pc1.", gsub(" ", ".", agg.arch.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_arch_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.sigma.pc1.", gsub(" ", ".", agg.arch.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_arch_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.arch)), rep(1:length(states.arch), 3))

theta.arch.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "arch")
theta.arch.plot.pc2 <- theta.arch.plot.pc2[theta.arch.plot.pc2$variable %in% filter.pars,]
theta.arch.plot.pc2$variable <- as.character(theta.arch.plot.pc2$variable)
theta.arch.plot.pc2 <- theta.arch.plot.pc2[!is.na(theta.arch.plot.pc2$value),]
theta.arch.plot.pc2 <- theta.arch.plot.pc2[theta.arch.plot.pc2$value >= -10 & theta.arch.plot.pc2$value <= 10, ]

alpha.arch.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "arch")
alpha.arch.plot.pc2 <- alpha.arch.plot.pc2[alpha.arch.plot.pc2$variable %in% filter.pars,]
alpha.arch.plot.pc2$variable <- as.character(alpha.arch.plot.pc2$variable)
alpha.arch.plot.pc2 <- alpha.arch.plot.pc2[!is.na(alpha.arch.plot.pc2$value),]
alpha.arch.plot.pc2 <- alpha.arch.plot.pc2[alpha.arch.plot.pc2$value >= -10 & alpha.arch.plot.pc2$value <= 10, ]

sigma.arch.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "arch")
sigma.arch.plot.pc2 <- sigma.arch.plot.pc2[sigma.arch.plot.pc2$variable %in% filter.pars,]
sigma.arch.plot.pc2$variable <- as.character(sigma.arch.plot.pc2$variable)
sigma.arch.plot.pc2 <- sigma.arch.plot.pc2[!is.na(sigma.arch.plot.pc2$value),]
sigma.arch.plot.pc2 <- sigma.arch.plot.pc2[sigma.arch.plot.pc2$value >= -10 & sigma.arch.plot.pc2$value <= 10, ]

theta.arch.pc2 <-
    ggplot(na.omit(theta.arch.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.arch.pc2 <-
    ggplot(na.omit(alpha.arch.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.arch.pc2 <-
    ggplot(na.omit(sigma.arch.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.arch.pc2 + alpha.arch.pc2 + sigma.arch.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_arch_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.theta.pc2.", gsub(" ", ".", agg.arch.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_arch_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.alpha.pc2.", gsub(" ", ".", agg.arch.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_arch_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.sigma.pc2.", gsub(" ", ".", agg.arch.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_arch_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.arch)), rep(1:length(states.arch), 3))

theta.arch.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "arch")
theta.arch.plot.pc3 <- theta.arch.plot.pc3[theta.arch.plot.pc3$variable %in% filter.pars,]
theta.arch.plot.pc3$variable <- as.character(theta.arch.plot.pc3$variable)
theta.arch.plot.pc3 <- theta.arch.plot.pc3[!is.na(theta.arch.plot.pc3$value),]
theta.arch.plot.pc3 <- theta.arch.plot.pc3[theta.arch.plot.pc3$value >= -10 & theta.arch.plot.pc3$value <= 10, ]

alpha.arch.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "arch")
alpha.arch.plot.pc3 <- alpha.arch.plot.pc3[alpha.arch.plot.pc3$variable %in% filter.pars,]
alpha.arch.plot.pc3$variable <- as.character(alpha.arch.plot.pc3$variable)
alpha.arch.plot.pc3 <- alpha.arch.plot.pc3[!is.na(alpha.arch.plot.pc3$value),]
alpha.arch.plot.pc3 <- alpha.arch.plot.pc3[alpha.arch.plot.pc3$value >= -10 & alpha.arch.plot.pc3$value <= 10, ]

sigma.arch.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "arch")
sigma.arch.plot.pc3 <- sigma.arch.plot.pc3[sigma.arch.plot.pc3$variable %in% filter.pars,]
sigma.arch.plot.pc3$variable <- as.character(sigma.arch.plot.pc3$variable)
sigma.arch.plot.pc3 <- sigma.arch.plot.pc3[!is.na(sigma.arch.plot.pc3$value),]
sigma.arch.plot.pc3 <- sigma.arch.plot.pc3[sigma.arch.plot.pc3$value >= -10 & sigma.arch.plot.pc3$value <= 10, ]

theta.arch.pc3 <-
    ggplot(na.omit(theta.arch.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.arch.pc3 <-
    ggplot(na.omit(alpha.arch.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.arch.pc3 <-
    ggplot(na.omit(sigma.arch.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.arch.pc3 + alpha.arch.pc3 + sigma.arch.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_arch_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.theta.pc3.", gsub(" ", ".", agg.arch.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_arch_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.alpha.pc3.", gsub(" ", ".", agg.arch.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_arch_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.sigma.pc3.", gsub(" ", ".", agg.arch.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```







# Domatium Growth

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_domgrow_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.domgrow)), rep(1:length(states.domgrow), 3))

theta.domgrow.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "domgrow")
theta.domgrow.plot.pc1 <- theta.domgrow.plot.pc1[theta.domgrow.plot.pc1$variable %in% filter.pars,]
theta.domgrow.plot.pc1$variable <- as.character(theta.domgrow.plot.pc1$variable)
theta.domgrow.plot.pc1 <- theta.domgrow.plot.pc1[!is.na(theta.domgrow.plot.pc1$value),]
theta.domgrow.plot.pc1 <- theta.domgrow.plot.pc1[theta.domgrow.plot.pc1$value >= -10 & theta.domgrow.plot.pc1$value <= 10, ]

alpha.domgrow.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "domgrow")
alpha.domgrow.plot.pc1 <- alpha.domgrow.plot.pc1[alpha.domgrow.plot.pc1$variable %in% filter.pars,]
alpha.domgrow.plot.pc1$variable <- as.character(alpha.domgrow.plot.pc1$variable)
alpha.domgrow.plot.pc1 <- alpha.domgrow.plot.pc1[!is.na(alpha.domgrow.plot.pc1$value),]
alpha.domgrow.plot.pc1 <- alpha.domgrow.plot.pc1[alpha.domgrow.plot.pc1$value >= -10 & alpha.domgrow.plot.pc1$value <= 10, ]

sigma.domgrow.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "domgrow")
sigma.domgrow.plot.pc1 <- sigma.domgrow.plot.pc1[sigma.domgrow.plot.pc1$variable %in% filter.pars,]
sigma.domgrow.plot.pc1$variable <- as.character(sigma.domgrow.plot.pc1$variable)
sigma.domgrow.plot.pc1 <- sigma.domgrow.plot.pc1[!is.na(sigma.domgrow.plot.pc1$value),]
sigma.domgrow.plot.pc1 <- sigma.domgrow.plot.pc1[sigma.domgrow.plot.pc1$value >= -10 & sigma.domgrow.plot.pc1$value <= 10, ]

theta.domgrow.pc1 <-
    ggplot(na.omit(theta.domgrow.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.domgrow.pc1 <-
    ggplot(na.omit(alpha.domgrow.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.domgrow.pc1 <-
    ggplot(na.omit(sigma.domgrow.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.domgrow.pc1 + alpha.domgrow.pc1 + sigma.domgrow.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_domgrow_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.theta.pc1.", gsub(" ", ".", agg.domgrow.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_domgrow_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.alpha.pc1.", gsub(" ", ".", agg.domgrow.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_domgrow_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.sigma.pc1.", gsub(" ", ".", agg.domgrow.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_domgrow_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.domgrow)), rep(1:length(states.domgrow), 3))

theta.domgrow.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "domgrow")
theta.domgrow.plot.pc2 <- theta.domgrow.plot.pc2[theta.domgrow.plot.pc2$variable %in% filter.pars,]
theta.domgrow.plot.pc2$variable <- as.character(theta.domgrow.plot.pc2$variable)
theta.domgrow.plot.pc2 <- theta.domgrow.plot.pc2[!is.na(theta.domgrow.plot.pc2$value),]
theta.domgrow.plot.pc2 <- theta.domgrow.plot.pc2[theta.domgrow.plot.pc2$value >= -10 & theta.domgrow.plot.pc2$value <= 10, ]

alpha.domgrow.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "domgrow")
alpha.domgrow.plot.pc2 <- alpha.domgrow.plot.pc2[alpha.domgrow.plot.pc2$variable %in% filter.pars,]
alpha.domgrow.plot.pc2$variable <- as.character(alpha.domgrow.plot.pc2$variable)
alpha.domgrow.plot.pc2 <- alpha.domgrow.plot.pc2[!is.na(alpha.domgrow.plot.pc2$value),]
alpha.domgrow.plot.pc2 <- alpha.domgrow.plot.pc2[alpha.domgrow.plot.pc2$value >= -10 & alpha.domgrow.plot.pc2$value <= 10, ]

sigma.domgrow.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "domgrow")
sigma.domgrow.plot.pc2 <- sigma.domgrow.plot.pc2[sigma.domgrow.plot.pc2$variable %in% filter.pars,]
sigma.domgrow.plot.pc2$variable <- as.character(sigma.domgrow.plot.pc2$variable)
sigma.domgrow.plot.pc2 <- sigma.domgrow.plot.pc2[!is.na(sigma.domgrow.plot.pc2$value),]
sigma.domgrow.plot.pc2 <- sigma.domgrow.plot.pc2[sigma.domgrow.plot.pc2$value >= -10 & sigma.domgrow.plot.pc2$value <= 10, ]

theta.domgrow.pc2 <-
    ggplot(na.omit(theta.domgrow.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.domgrow.pc2 <-
    ggplot(na.omit(alpha.domgrow.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.domgrow.pc2 <-
    ggplot(na.omit(sigma.domgrow.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.domgrow.pc2 + alpha.domgrow.pc2 + sigma.domgrow.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_domgrow_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.theta.pc2.", gsub(" ", ".", agg.domgrow.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_domgrow_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.alpha.pc2.", gsub(" ", ".", agg.domgrow.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_domgrow_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.sigma.pc2.", gsub(" ", ".", agg.domgrow.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_domgrow_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.domgrow)), rep(1:length(states.domgrow), 3))

theta.domgrow.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "domgrow")
theta.domgrow.plot.pc3 <- theta.domgrow.plot.pc3[theta.domgrow.plot.pc3$variable %in% filter.pars,]
theta.domgrow.plot.pc3$variable <- as.character(theta.domgrow.plot.pc3$variable)
theta.domgrow.plot.pc3 <- theta.domgrow.plot.pc3[!is.na(theta.domgrow.plot.pc3$value),]
theta.domgrow.plot.pc3 <- theta.domgrow.plot.pc3[theta.domgrow.plot.pc3$value >= -10 & theta.domgrow.plot.pc3$value <= 10, ]

alpha.domgrow.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "domgrow")
alpha.domgrow.plot.pc3 <- alpha.domgrow.plot.pc3[alpha.domgrow.plot.pc3$variable %in% filter.pars,]
alpha.domgrow.plot.pc3$variable <- as.character(alpha.domgrow.plot.pc3$variable)
alpha.domgrow.plot.pc3 <- alpha.domgrow.plot.pc3[!is.na(alpha.domgrow.plot.pc3$value),]
alpha.domgrow.plot.pc3 <- alpha.domgrow.plot.pc3[alpha.domgrow.plot.pc3$value >= -10 & alpha.domgrow.plot.pc3$value <= 10, ]

sigma.domgrow.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "domgrow")
sigma.domgrow.plot.pc3 <- sigma.domgrow.plot.pc3[sigma.domgrow.plot.pc3$variable %in% filter.pars,]
sigma.domgrow.plot.pc3$variable <- as.character(sigma.domgrow.plot.pc3$variable)
sigma.domgrow.plot.pc3 <- sigma.domgrow.plot.pc3[!is.na(sigma.domgrow.plot.pc3$value),]
sigma.domgrow.plot.pc3 <- sigma.domgrow.plot.pc3[sigma.domgrow.plot.pc3$value >= -10 & sigma.domgrow.plot.pc3$value <= 10, ]

theta.domgrow.pc3 <-
    ggplot(na.omit(theta.domgrow.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.domgrow.pc3 <-
    ggplot(na.omit(alpha.domgrow.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.domgrow.pc3 <-
    ggplot(na.omit(sigma.domgrow.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.domgrow.pc3 + alpha.domgrow.pc3 + sigma.domgrow.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_domgrow_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.theta.pc3.", gsub(" ", ".", agg.domgrow.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_domgrow_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.alpha.pc3.", gsub(" ", ".", agg.domgrow.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_domgrow_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.sigma.pc3.", gsub(" ", ".", agg.domgrow.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```






# Leaf Structure

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_leafstruc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.leafstruc)), rep(1:length(states.leafstruc), 3))

theta.leafstruc.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "leafstruc")
theta.leafstruc.plot.pc1 <- theta.leafstruc.plot.pc1[theta.leafstruc.plot.pc1$variable %in% filter.pars,]
theta.leafstruc.plot.pc1$variable <- as.character(theta.leafstruc.plot.pc1$variable)
theta.leafstruc.plot.pc1 <- theta.leafstruc.plot.pc1[!is.na(theta.leafstruc.plot.pc1$value),]
theta.leafstruc.plot.pc1 <- theta.leafstruc.plot.pc1[theta.leafstruc.plot.pc1$value >= -10 & theta.leafstruc.plot.pc1$value <= 10, ]

alpha.leafstruc.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "leafstruc")
alpha.leafstruc.plot.pc1 <- alpha.leafstruc.plot.pc1[alpha.leafstruc.plot.pc1$variable %in% filter.pars,]
alpha.leafstruc.plot.pc1$variable <- as.character(alpha.leafstruc.plot.pc1$variable)
alpha.leafstruc.plot.pc1 <- alpha.leafstruc.plot.pc1[!is.na(alpha.leafstruc.plot.pc1$value),]
alpha.leafstruc.plot.pc1 <- alpha.leafstruc.plot.pc1[alpha.leafstruc.plot.pc1$value >= -10 & alpha.leafstruc.plot.pc1$value <= 10, ]

sigma.leafstruc.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "leafstruc")
sigma.leafstruc.plot.pc1 <- sigma.leafstruc.plot.pc1[sigma.leafstruc.plot.pc1$variable %in% filter.pars,]
sigma.leafstruc.plot.pc1$variable <- as.character(sigma.leafstruc.plot.pc1$variable)
sigma.leafstruc.plot.pc1 <- sigma.leafstruc.plot.pc1[!is.na(sigma.leafstruc.plot.pc1$value),]
sigma.leafstruc.plot.pc1 <- sigma.leafstruc.plot.pc1[sigma.leafstruc.plot.pc1$value >= -10 & sigma.leafstruc.plot.pc1$value <= 10, ]

theta.leafstruc.pc1 <-
    ggplot(na.omit(theta.leafstruc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.leafstruc.pc1 <-
    ggplot(na.omit(alpha.leafstruc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.leafstruc.pc1 <-
    ggplot(na.omit(sigma.leafstruc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.leafstruc.pc1 + alpha.leafstruc.pc1 + sigma.leafstruc.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_leafstruc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.theta.pc1.", gsub(" ", ".", agg.leafstruc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_leafstruc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.alpha.pc1.", gsub(" ", ".", agg.leafstruc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_leafstruc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.sigma.pc1.", gsub(" ", ".", agg.leafstruc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_leafstruc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.leafstruc)), rep(1:length(states.leafstruc), 3))

theta.leafstruc.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "leafstruc")
theta.leafstruc.plot.pc2 <- theta.leafstruc.plot.pc2[theta.leafstruc.plot.pc2$variable %in% filter.pars,]
theta.leafstruc.plot.pc2$variable <- as.character(theta.leafstruc.plot.pc2$variable)
theta.leafstruc.plot.pc2 <- theta.leafstruc.plot.pc2[!is.na(theta.leafstruc.plot.pc2$value),]
theta.leafstruc.plot.pc2 <- theta.leafstruc.plot.pc2[theta.leafstruc.plot.pc2$value >= -10 & theta.leafstruc.plot.pc2$value <= 10, ]

alpha.leafstruc.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "leafstruc")
alpha.leafstruc.plot.pc2 <- alpha.leafstruc.plot.pc2[alpha.leafstruc.plot.pc2$variable %in% filter.pars,]
alpha.leafstruc.plot.pc2$variable <- as.character(alpha.leafstruc.plot.pc2$variable)
alpha.leafstruc.plot.pc2 <- alpha.leafstruc.plot.pc2[!is.na(alpha.leafstruc.plot.pc2$value),]
alpha.leafstruc.plot.pc2 <- alpha.leafstruc.plot.pc2[alpha.leafstruc.plot.pc2$value >= -10 & alpha.leafstruc.plot.pc2$value <= 10, ]

sigma.leafstruc.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "leafstruc")
sigma.leafstruc.plot.pc2 <- sigma.leafstruc.plot.pc2[sigma.leafstruc.plot.pc2$variable %in% filter.pars,]
sigma.leafstruc.plot.pc2$variable <- as.character(sigma.leafstruc.plot.pc2$variable)
sigma.leafstruc.plot.pc2 <- sigma.leafstruc.plot.pc2[!is.na(sigma.leafstruc.plot.pc2$value),]
sigma.leafstruc.plot.pc2 <- sigma.leafstruc.plot.pc2[sigma.leafstruc.plot.pc2$value >= -10 & sigma.leafstruc.plot.pc2$value <= 10, ]

theta.leafstruc.pc2 <-
    ggplot(na.omit(theta.leafstruc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.leafstruc.pc2 <-
    ggplot(na.omit(alpha.leafstruc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.leafstruc.pc2 <-
    ggplot(na.omit(sigma.leafstruc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.leafstruc.pc2 + alpha.leafstruc.pc2 + sigma.leafstruc.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_leafstruc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.theta.pc2.", gsub(" ", ".", agg.leafstruc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_leafstruc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.alpha.pc2.", gsub(" ", ".", agg.leafstruc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_leafstruc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.sigma.pc2.", gsub(" ", ".", agg.leafstruc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_leafstruc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.leafstruc)), rep(1:length(states.leafstruc), 3))

theta.leafstruc.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "leafstruc")
theta.leafstruc.plot.pc3 <- theta.leafstruc.plot.pc3[theta.leafstruc.plot.pc3$variable %in% filter.pars,]
theta.leafstruc.plot.pc3$variable <- as.character(theta.leafstruc.plot.pc3$variable)
theta.leafstruc.plot.pc3 <- theta.leafstruc.plot.pc3[!is.na(theta.leafstruc.plot.pc3$value),]
theta.leafstruc.plot.pc3 <- theta.leafstruc.plot.pc3[theta.leafstruc.plot.pc3$value >= -10 & theta.leafstruc.plot.pc3$value <= 10, ]

alpha.leafstruc.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "leafstruc")
alpha.leafstruc.plot.pc3 <- alpha.leafstruc.plot.pc3[alpha.leafstruc.plot.pc3$variable %in% filter.pars,]
alpha.leafstruc.plot.pc3$variable <- as.character(alpha.leafstruc.plot.pc3$variable)
alpha.leafstruc.plot.pc3 <- alpha.leafstruc.plot.pc3[!is.na(alpha.leafstruc.plot.pc3$value),]
alpha.leafstruc.plot.pc3 <- alpha.leafstruc.plot.pc3[alpha.leafstruc.plot.pc3$value >= -10 & alpha.leafstruc.plot.pc3$value <= 10, ]

sigma.leafstruc.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "leafstruc")
sigma.leafstruc.plot.pc3 <- sigma.leafstruc.plot.pc3[sigma.leafstruc.plot.pc3$variable %in% filter.pars,]
sigma.leafstruc.plot.pc3$variable <- as.character(sigma.leafstruc.plot.pc3$variable)
sigma.leafstruc.plot.pc3 <- sigma.leafstruc.plot.pc3[!is.na(sigma.leafstruc.plot.pc3$value),]
sigma.leafstruc.plot.pc3 <- sigma.leafstruc.plot.pc3[sigma.leafstruc.plot.pc3$value >= -10 & sigma.leafstruc.plot.pc3$value <= 10, ]

theta.leafstruc.pc3 <-
    ggplot(na.omit(theta.leafstruc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.leafstruc.pc3 <-
    ggplot(na.omit(alpha.leafstruc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.leafstruc.pc3 <-
    ggplot(na.omit(sigma.leafstruc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.leafstruc.pc3 + alpha.leafstruc.pc3 + sigma.leafstruc.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_leafstruc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.theta.pc3.", gsub(" ", ".", agg.leafstruc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_leafstruc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.alpha.pc3.", gsub(" ", ".", agg.leafstruc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_leafstruc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.sigma.pc3.", gsub(" ", ".", agg.leafstruc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```






# Mating System

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_matsys_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.matsys)), rep(1:length(states.matsys), 3))

theta.matsys.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "matsys")
theta.matsys.plot.pc1 <- theta.matsys.plot.pc1[theta.matsys.plot.pc1$variable %in% filter.pars,]
theta.matsys.plot.pc1$variable <- as.character(theta.matsys.plot.pc1$variable)
theta.matsys.plot.pc1 <- theta.matsys.plot.pc1[!is.na(theta.matsys.plot.pc1$value),]
theta.matsys.plot.pc1 <- theta.matsys.plot.pc1[theta.matsys.plot.pc1$value >= -10 & theta.matsys.plot.pc1$value <= 10, ]

alpha.matsys.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "matsys")
alpha.matsys.plot.pc1 <- alpha.matsys.plot.pc1[alpha.matsys.plot.pc1$variable %in% filter.pars,]
alpha.matsys.plot.pc1$variable <- as.character(alpha.matsys.plot.pc1$variable)
alpha.matsys.plot.pc1 <- alpha.matsys.plot.pc1[!is.na(alpha.matsys.plot.pc1$value),]
alpha.matsys.plot.pc1 <- alpha.matsys.plot.pc1[alpha.matsys.plot.pc1$value >= -10 & alpha.matsys.plot.pc1$value <= 10, ]

sigma.matsys.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "matsys")
sigma.matsys.plot.pc1 <- sigma.matsys.plot.pc1[sigma.matsys.plot.pc1$variable %in% filter.pars,]
sigma.matsys.plot.pc1$variable <- as.character(sigma.matsys.plot.pc1$variable)
sigma.matsys.plot.pc1 <- sigma.matsys.plot.pc1[!is.na(sigma.matsys.plot.pc1$value),]
sigma.matsys.plot.pc1 <- sigma.matsys.plot.pc1[sigma.matsys.plot.pc1$value >= -10 & sigma.matsys.plot.pc1$value <= 10, ]

theta.matsys.pc1 <-
    ggplot(na.omit(theta.matsys.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.matsys.pc1 <-
    ggplot(na.omit(alpha.matsys.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.matsys.pc1 <-
    ggplot(na.omit(sigma.matsys.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.matsys.pc1 + alpha.matsys.pc1 + sigma.matsys.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_matsys_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.theta.pc1.", gsub(" ", ".", agg.matsys.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_matsys_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.alpha.pc1.", gsub(" ", ".", agg.matsys.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_matsys_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.sigma.pc1.", gsub(" ", ".", agg.matsys.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_matsys_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.matsys)), rep(1:length(states.matsys), 3))

theta.matsys.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "matsys")
theta.matsys.plot.pc2 <- theta.matsys.plot.pc2[theta.matsys.plot.pc2$variable %in% filter.pars,]
theta.matsys.plot.pc2$variable <- as.character(theta.matsys.plot.pc2$variable)
theta.matsys.plot.pc2 <- theta.matsys.plot.pc2[!is.na(theta.matsys.plot.pc2$value),]
theta.matsys.plot.pc2 <- theta.matsys.plot.pc2[theta.matsys.plot.pc2$value >= -10 & theta.matsys.plot.pc2$value <= 10, ]

alpha.matsys.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "matsys")
alpha.matsys.plot.pc2 <- alpha.matsys.plot.pc2[alpha.matsys.plot.pc2$variable %in% filter.pars,]
alpha.matsys.plot.pc2$variable <- as.character(alpha.matsys.plot.pc2$variable)
alpha.matsys.plot.pc2 <- alpha.matsys.plot.pc2[!is.na(alpha.matsys.plot.pc2$value),]
alpha.matsys.plot.pc2 <- alpha.matsys.plot.pc2[alpha.matsys.plot.pc2$value >= -10 & alpha.matsys.plot.pc2$value <= 10, ]

sigma.matsys.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "matsys")
sigma.matsys.plot.pc2 <- sigma.matsys.plot.pc2[sigma.matsys.plot.pc2$variable %in% filter.pars,]
sigma.matsys.plot.pc2$variable <- as.character(sigma.matsys.plot.pc2$variable)
sigma.matsys.plot.pc2 <- sigma.matsys.plot.pc2[!is.na(sigma.matsys.plot.pc2$value),]
sigma.matsys.plot.pc2 <- sigma.matsys.plot.pc2[sigma.matsys.plot.pc2$value >= -10 & sigma.matsys.plot.pc2$value <= 10, ]

theta.matsys.pc2 <-
    ggplot(na.omit(theta.matsys.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.matsys.pc2 <-
    ggplot(na.omit(alpha.matsys.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.matsys.pc2 <-
    ggplot(na.omit(sigma.matsys.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.matsys.pc2 + alpha.matsys.pc2 + sigma.matsys.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_matsys_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.theta.pc2.", gsub(" ", ".", agg.matsys.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_matsys_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.alpha.pc2.", gsub(" ", ".", agg.matsys.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_matsys_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.sigma.pc2.", gsub(" ", ".", agg.matsys.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_matsys_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.matsys)), rep(1:length(states.matsys), 3))

theta.matsys.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "matsys")
theta.matsys.plot.pc3 <- theta.matsys.plot.pc3[theta.matsys.plot.pc3$variable %in% filter.pars,]
theta.matsys.plot.pc3$variable <- as.character(theta.matsys.plot.pc3$variable)
theta.matsys.plot.pc3 <- theta.matsys.plot.pc3[!is.na(theta.matsys.plot.pc3$value),]
theta.matsys.plot.pc3 <- theta.matsys.plot.pc3[theta.matsys.plot.pc3$value >= -10 & theta.matsys.plot.pc3$value <= 10, ]

alpha.matsys.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "matsys")
alpha.matsys.plot.pc3 <- alpha.matsys.plot.pc3[alpha.matsys.plot.pc3$variable %in% filter.pars,]
alpha.matsys.plot.pc3$variable <- as.character(alpha.matsys.plot.pc3$variable)
alpha.matsys.plot.pc3 <- alpha.matsys.plot.pc3[!is.na(alpha.matsys.plot.pc3$value),]
alpha.matsys.plot.pc3 <- alpha.matsys.plot.pc3[alpha.matsys.plot.pc3$value >= -10 & alpha.matsys.plot.pc3$value <= 10, ]

sigma.matsys.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "matsys")
sigma.matsys.plot.pc3 <- sigma.matsys.plot.pc3[sigma.matsys.plot.pc3$variable %in% filter.pars,]
sigma.matsys.plot.pc3$variable <- as.character(sigma.matsys.plot.pc3$variable)
sigma.matsys.plot.pc3 <- sigma.matsys.plot.pc3[!is.na(sigma.matsys.plot.pc3$value),]
sigma.matsys.plot.pc3 <- sigma.matsys.plot.pc3[sigma.matsys.plot.pc3$value >= -10 & sigma.matsys.plot.pc3$value <= 10, ]

theta.matsys.pc3 <-
    ggplot(na.omit(theta.matsys.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.matsys.pc3 <-
    ggplot(na.omit(alpha.matsys.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.matsys.pc3 <-
    ggplot(na.omit(sigma.matsys.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.matsys.pc3 + alpha.matsys.pc3 + sigma.matsys.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_matsys_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.theta.pc3.", gsub(" ", ".", agg.matsys.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_matsys_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.alpha.pc3.", gsub(" ", ".", agg.matsys.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_matsys_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.sigma.pc3.", gsub(" ", ".", agg.matsys.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```






# Reward

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_reward_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.reward)), rep(1:length(states.reward), 3))

theta.reward.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "reward")
theta.reward.plot.pc1 <- theta.reward.plot.pc1[theta.reward.plot.pc1$variable %in% filter.pars,]
theta.reward.plot.pc1$variable <- as.character(theta.reward.plot.pc1$variable)
theta.reward.plot.pc1 <- theta.reward.plot.pc1[!is.na(theta.reward.plot.pc1$value),]
theta.reward.plot.pc1 <- theta.reward.plot.pc1[theta.reward.plot.pc1$value >= -10 & theta.reward.plot.pc1$value <= 10, ]

alpha.reward.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "reward")
alpha.reward.plot.pc1 <- alpha.reward.plot.pc1[alpha.reward.plot.pc1$variable %in% filter.pars,]
alpha.reward.plot.pc1$variable <- as.character(alpha.reward.plot.pc1$variable)
alpha.reward.plot.pc1 <- alpha.reward.plot.pc1[!is.na(alpha.reward.plot.pc1$value),]
alpha.reward.plot.pc1 <- alpha.reward.plot.pc1[alpha.reward.plot.pc1$value >= -10 & alpha.reward.plot.pc1$value <= 10, ]

sigma.reward.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "reward")
sigma.reward.plot.pc1 <- sigma.reward.plot.pc1[sigma.reward.plot.pc1$variable %in% filter.pars,]
sigma.reward.plot.pc1$variable <- as.character(sigma.reward.plot.pc1$variable)
sigma.reward.plot.pc1 <- sigma.reward.plot.pc1[!is.na(sigma.reward.plot.pc1$value),]
sigma.reward.plot.pc1 <- sigma.reward.plot.pc1[sigma.reward.plot.pc1$value >= -10 & sigma.reward.plot.pc1$value <= 10, ]

theta.reward.pc1 <-
    ggplot(na.omit(theta.reward.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.reward.pc1 <-
    ggplot(na.omit(alpha.reward.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.reward.pc1 <-
    ggplot(na.omit(sigma.reward.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.reward.pc1 + alpha.reward.pc1 + sigma.reward.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_reward_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.theta.pc1.", gsub(" ", ".", agg.reward.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_reward_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.alpha.pc1.", gsub(" ", ".", agg.reward.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_reward_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.sigma.pc1.", gsub(" ", ".", agg.reward.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameter

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r pars_ouwie_reward_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.reward)), rep(1:length(states.reward), 3))

theta.reward.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "reward")
theta.reward.plot.pc2 <- theta.reward.plot.pc2[theta.reward.plot.pc2$variable %in% filter.pars,]
theta.reward.plot.pc2$variable <- as.character(theta.reward.plot.pc2$variable)
theta.reward.plot.pc2 <- theta.reward.plot.pc2[!is.na(theta.reward.plot.pc2$value),]
theta.reward.plot.pc2 <- theta.reward.plot.pc2[theta.reward.plot.pc2$value >= -10 & theta.reward.plot.pc2$value <= 10, ]

alpha.reward.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "reward")
alpha.reward.plot.pc2 <- alpha.reward.plot.pc2[alpha.reward.plot.pc2$variable %in% filter.pars,]
alpha.reward.plot.pc2$variable <- as.character(alpha.reward.plot.pc2$variable)
alpha.reward.plot.pc2 <- alpha.reward.plot.pc2[!is.na(alpha.reward.plot.pc2$value),]
alpha.reward.plot.pc2 <- alpha.reward.plot.pc2[alpha.reward.plot.pc2$value >= -10 & alpha.reward.plot.pc2$value <= 10, ]

sigma.reward.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "reward")
sigma.reward.plot.pc2 <- sigma.reward.plot.pc2[sigma.reward.plot.pc2$variable %in% filter.pars,]
sigma.reward.plot.pc2$variable <- as.character(sigma.reward.plot.pc2$variable)
sigma.reward.plot.pc2 <- sigma.reward.plot.pc2[!is.na(sigma.reward.plot.pc2$value),]
sigma.reward.plot.pc2 <- sigma.reward.plot.pc2[sigma.reward.plot.pc2$value >= -10 & sigma.reward.plot.pc2$value <= 10, ]

theta.reward.pc2 <-
    ggplot(na.omit(theta.reward.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.reward.pc2 <-
    ggplot(na.omit(alpha.reward.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.reward.pc2 <-
    ggplot(na.omit(sigma.reward.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.reward.pc2 + alpha.reward.pc2 + sigma.reward.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_reward_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.theta.pc2.", gsub(" ", ".", agg.reward.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_reward_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.alpha.pc2.", gsub(" ", ".", agg.reward.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_reward_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.sigma.pc2.", gsub(" ", ".", agg.reward.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_reward_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.reward)), rep(1:length(states.reward), 3))

theta.reward.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "reward")
theta.reward.plot.pc3 <- theta.reward.plot.pc3[theta.reward.plot.pc3$variable %in% filter.pars,]
theta.reward.plot.pc3$variable <- as.character(theta.reward.plot.pc3$variable)
theta.reward.plot.pc3 <- theta.reward.plot.pc3[!is.na(theta.reward.plot.pc3$value),]
theta.reward.plot.pc3 <- theta.reward.plot.pc3[theta.reward.plot.pc3$value >= -10 & theta.reward.plot.pc3$value <= 10, ]

alpha.reward.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "reward")
alpha.reward.plot.pc3 <- alpha.reward.plot.pc3[alpha.reward.plot.pc3$variable %in% filter.pars,]
alpha.reward.plot.pc3$variable <- as.character(alpha.reward.plot.pc3$variable)
alpha.reward.plot.pc3 <- alpha.reward.plot.pc3[!is.na(alpha.reward.plot.pc3$value),]
alpha.reward.plot.pc3 <- alpha.reward.plot.pc3[alpha.reward.plot.pc3$value >= -10 & alpha.reward.plot.pc3$value <= 10, ]

sigma.reward.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "reward")
sigma.reward.plot.pc3 <- sigma.reward.plot.pc3[sigma.reward.plot.pc3$variable %in% filter.pars,]
sigma.reward.plot.pc3$variable <- as.character(sigma.reward.plot.pc3$variable)
sigma.reward.plot.pc3 <- sigma.reward.plot.pc3[!is.na(sigma.reward.plot.pc3$value),]
sigma.reward.plot.pc3 <- sigma.reward.plot.pc3[sigma.reward.plot.pc3$value >= -10 & sigma.reward.plot.pc3$value <= 10, ]

theta.reward.pc3 <-
    ggplot(na.omit(theta.reward.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.reward.pc3 <-
    ggplot(na.omit(alpha.reward.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.reward.pc3 <-
    ggplot(na.omit(sigma.reward.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.reward.pc3 + alpha.reward.pc3 + sigma.reward.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_reward_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.theta.pc3.", gsub(" ", ".", agg.reward.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_reward_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.alpha.pc3.", gsub(" ", ".", agg.reward.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_reward_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.sigma.pc3.", gsub(" ", ".", agg.reward.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```





# Strategy

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_strategy_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.strategy)), rep(1:length(states.strategy), 3))

theta.strategy.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "strategy")
theta.strategy.plot.pc1 <- theta.strategy.plot.pc1[theta.strategy.plot.pc1$variable %in% filter.pars,]
theta.strategy.plot.pc1$variable <- as.character(theta.strategy.plot.pc1$variable)
theta.strategy.plot.pc1 <- theta.strategy.plot.pc1[!is.na(theta.strategy.plot.pc1$value),]
theta.strategy.plot.pc1 <- theta.strategy.plot.pc1[theta.strategy.plot.pc1$value >= -10 & theta.strategy.plot.pc1$value <= 10, ]

alpha.strategy.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "strategy")
alpha.strategy.plot.pc1 <- alpha.strategy.plot.pc1[alpha.strategy.plot.pc1$variable %in% filter.pars,]
alpha.strategy.plot.pc1$variable <- as.character(alpha.strategy.plot.pc1$variable)
alpha.strategy.plot.pc1 <- alpha.strategy.plot.pc1[!is.na(alpha.strategy.plot.pc1$value),]
alpha.strategy.plot.pc1 <- alpha.strategy.plot.pc1[alpha.strategy.plot.pc1$value >= -10 & alpha.strategy.plot.pc1$value <= 10, ]

sigma.strategy.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "strategy")
sigma.strategy.plot.pc1 <- sigma.strategy.plot.pc1[sigma.strategy.plot.pc1$variable %in% filter.pars,]
sigma.strategy.plot.pc1$variable <- as.character(sigma.strategy.plot.pc1$variable)
sigma.strategy.plot.pc1 <- sigma.strategy.plot.pc1[!is.na(sigma.strategy.plot.pc1$value),]
sigma.strategy.plot.pc1 <- sigma.strategy.plot.pc1[sigma.strategy.plot.pc1$value >= -10 & sigma.strategy.plot.pc1$value <= 10, ]

theta.strategy.pc1 <-
    ggplot(na.omit(theta.strategy.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.strategy.pc1 <-
    ggplot(na.omit(alpha.strategy.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.strategy.pc1 <-
    ggplot(na.omit(sigma.strategy.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.strategy.pc1 + alpha.strategy.pc1 + sigma.strategy.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_strategy_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.theta.pc1.", gsub(" ", ".", agg.strategy.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_strategy_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.alpha.pc1.", gsub(" ", ".", agg.strategy.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_strategy_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.sigma.pc1.", gsub(" ", ".", agg.strategy.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_strategy_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.strategy)), rep(1:length(states.strategy), 3))

theta.strategy.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "strategy")
theta.strategy.plot.pc2 <- theta.strategy.plot.pc2[theta.strategy.plot.pc2$variable %in% filter.pars,]
theta.strategy.plot.pc2$variable <- as.character(theta.strategy.plot.pc2$variable)
theta.strategy.plot.pc2 <- theta.strategy.plot.pc2[!is.na(theta.strategy.plot.pc2$value),]
theta.strategy.plot.pc2 <- theta.strategy.plot.pc2[theta.strategy.plot.pc2$value >= -10 & theta.strategy.plot.pc2$value <= 10, ]

alpha.strategy.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "strategy")
alpha.strategy.plot.pc2 <- alpha.strategy.plot.pc2[alpha.strategy.plot.pc2$variable %in% filter.pars,]
alpha.strategy.plot.pc2$variable <- as.character(alpha.strategy.plot.pc2$variable)
alpha.strategy.plot.pc2 <- alpha.strategy.plot.pc2[!is.na(alpha.strategy.plot.pc2$value),]
alpha.strategy.plot.pc2 <- alpha.strategy.plot.pc2[alpha.strategy.plot.pc2$value >= -10 & alpha.strategy.plot.pc2$value <= 10, ]

sigma.strategy.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "strategy")
sigma.strategy.plot.pc2 <- sigma.strategy.plot.pc2[sigma.strategy.plot.pc2$variable %in% filter.pars,]
sigma.strategy.plot.pc2$variable <- as.character(sigma.strategy.plot.pc2$variable)
sigma.strategy.plot.pc2 <- sigma.strategy.plot.pc2[!is.na(sigma.strategy.plot.pc2$value),]
sigma.strategy.plot.pc2 <- sigma.strategy.plot.pc2[sigma.strategy.plot.pc2$value >= -10 & sigma.strategy.plot.pc2$value <= 10, ]

theta.strategy.pc2 <-
    ggplot(na.omit(theta.strategy.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.strategy.pc2 <-
    ggplot(na.omit(alpha.strategy.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.strategy.pc2 <-
    ggplot(na.omit(sigma.strategy.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.strategy.pc2 + alpha.strategy.pc2 + sigma.strategy.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_strategy_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.theta.pc2.", gsub(" ", ".", agg.strategy.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_strategy_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.alpha.pc2.", gsub(" ", ".", agg.strategy.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_strategy_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.sigma.pc2.", gsub(" ", ".", agg.strategy.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_strategy_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.strategy)), rep(1:length(states.strategy), 3))

theta.strategy.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "strategy")
theta.strategy.plot.pc3 <- theta.strategy.plot.pc3[theta.strategy.plot.pc3$variable %in% filter.pars,]
theta.strategy.plot.pc3$variable <- as.character(theta.strategy.plot.pc3$variable)
theta.strategy.plot.pc3 <- theta.strategy.plot.pc3[!is.na(theta.strategy.plot.pc3$value),]
theta.strategy.plot.pc3 <- theta.strategy.plot.pc3[theta.strategy.plot.pc3$value >= -10 & theta.strategy.plot.pc3$value <= 10, ]

alpha.strategy.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "strategy")
alpha.strategy.plot.pc3 <- alpha.strategy.plot.pc3[alpha.strategy.plot.pc3$variable %in% filter.pars,]
alpha.strategy.plot.pc3$variable <- as.character(alpha.strategy.plot.pc3$variable)
alpha.strategy.plot.pc3 <- alpha.strategy.plot.pc3[!is.na(alpha.strategy.plot.pc3$value),]
alpha.strategy.plot.pc3 <- alpha.strategy.plot.pc3[alpha.strategy.plot.pc3$value >= -10 & alpha.strategy.plot.pc3$value <= 10, ]

sigma.strategy.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "strategy")
sigma.strategy.plot.pc3 <- sigma.strategy.plot.pc3[sigma.strategy.plot.pc3$variable %in% filter.pars,]
sigma.strategy.plot.pc3$variable <- as.character(sigma.strategy.plot.pc3$variable)
sigma.strategy.plot.pc3 <- sigma.strategy.plot.pc3[!is.na(sigma.strategy.plot.pc3$value),]
sigma.strategy.plot.pc3 <- sigma.strategy.plot.pc3[sigma.strategy.plot.pc3$value >= -10 & sigma.strategy.plot.pc3$value <= 10, ]

theta.strategy.pc3 <-
    ggplot(na.omit(theta.strategy.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.strategy.pc3 <-
    ggplot(na.omit(alpha.strategy.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.strategy.pc3 <-
    ggplot(na.omit(sigma.strategy.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.strategy.pc3 + alpha.strategy.pc3 + sigma.strategy.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_strategy_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.theta.pc3.", gsub(" ", ".", agg.strategy.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_strategy_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.alpha.pc3.", gsub(" ", ".", agg.strategy.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_strategy_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.sigma.pc3.", gsub(" ", ".", agg.strategy.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```







# Warts

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_warts_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.warts)), rep(1:length(states.warts), 3))

theta.warts.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "warts")
theta.warts.plot.pc1 <- theta.warts.plot.pc1[theta.warts.plot.pc1$variable %in% filter.pars,]
theta.warts.plot.pc1$variable <- as.character(theta.warts.plot.pc1$variable)
theta.warts.plot.pc1 <- theta.warts.plot.pc1[!is.na(theta.warts.plot.pc1$value),]
theta.warts.plot.pc1 <- theta.warts.plot.pc1[theta.warts.plot.pc1$value >= -10 & theta.warts.plot.pc1$value <= 10, ]

alpha.warts.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "warts")
alpha.warts.plot.pc1 <- alpha.warts.plot.pc1[alpha.warts.plot.pc1$variable %in% filter.pars,]
alpha.warts.plot.pc1$variable <- as.character(alpha.warts.plot.pc1$variable)
alpha.warts.plot.pc1 <- alpha.warts.plot.pc1[!is.na(alpha.warts.plot.pc1$value),]
alpha.warts.plot.pc1 <- alpha.warts.plot.pc1[alpha.warts.plot.pc1$value >= -10 & alpha.warts.plot.pc1$value <= 10, ]

sigma.warts.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "warts")
sigma.warts.plot.pc1 <- sigma.warts.plot.pc1[sigma.warts.plot.pc1$variable %in% filter.pars,]
sigma.warts.plot.pc1$variable <- as.character(sigma.warts.plot.pc1$variable)
sigma.warts.plot.pc1 <- sigma.warts.plot.pc1[!is.na(sigma.warts.plot.pc1$value),]
sigma.warts.plot.pc1 <- sigma.warts.plot.pc1[sigma.warts.plot.pc1$value >= -10 & sigma.warts.plot.pc1$value <= 10, ]

theta.warts.pc1 <-
    ggplot(na.omit(theta.warts.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.warts.pc1 <-
    ggplot(na.omit(alpha.warts.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.warts.pc1 <-
    ggplot(na.omit(sigma.warts.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.warts.pc1 + alpha.warts.pc1 + sigma.warts.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_warts_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.theta.pc1.", gsub(" ", ".", agg.warts.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_warts_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.alpha.pc1.", gsub(" ", ".", agg.warts.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_warts_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.sigma.pc1.", gsub(" ", ".", agg.warts.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_warts_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.warts)), rep(1:length(states.warts), 3))

theta.warts.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "warts")
theta.warts.plot.pc2 <- theta.warts.plot.pc2[theta.warts.plot.pc2$variable %in% filter.pars,]
theta.warts.plot.pc2$variable <- as.character(theta.warts.plot.pc2$variable)
theta.warts.plot.pc2 <- theta.warts.plot.pc2[!is.na(theta.warts.plot.pc2$value),]
theta.warts.plot.pc2 <- theta.warts.plot.pc2[theta.warts.plot.pc2$value >= -10 & theta.warts.plot.pc2$value <= 10, ]

alpha.warts.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "warts")
alpha.warts.plot.pc2 <- alpha.warts.plot.pc2[alpha.warts.plot.pc2$variable %in% filter.pars,]
alpha.warts.plot.pc2$variable <- as.character(alpha.warts.plot.pc2$variable)
alpha.warts.plot.pc2 <- alpha.warts.plot.pc2[!is.na(alpha.warts.plot.pc2$value),]
alpha.warts.plot.pc2 <- alpha.warts.plot.pc2[alpha.warts.plot.pc2$value >= -10 & alpha.warts.plot.pc2$value <= 10, ]

sigma.warts.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "warts")
sigma.warts.plot.pc2 <- sigma.warts.plot.pc2[sigma.warts.plot.pc2$variable %in% filter.pars,]
sigma.warts.plot.pc2$variable <- as.character(sigma.warts.plot.pc2$variable)
sigma.warts.plot.pc2 <- sigma.warts.plot.pc2[!is.na(sigma.warts.plot.pc2$value),]
sigma.warts.plot.pc2 <- sigma.warts.plot.pc2[sigma.warts.plot.pc2$value >= -10 & sigma.warts.plot.pc2$value <= 10, ]

theta.warts.pc2 <-
    ggplot(na.omit(theta.warts.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.warts.pc2 <-
    ggplot(na.omit(alpha.warts.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.warts.pc2 <-
    ggplot(na.omit(sigma.warts.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.warts.pc2 + alpha.warts.pc2 + sigma.warts.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_warts_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.theta.pc2.", gsub(" ", ".", agg.warts.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_warts_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.alpha.pc2.", gsub(" ", ".", agg.warts.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_warts_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.sigma.pc2.", gsub(" ", ".", agg.warts.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_warts_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.warts)), rep(1:length(states.warts), 3))

theta.warts.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "warts")
theta.warts.plot.pc3 <- theta.warts.plot.pc3[theta.warts.plot.pc3$variable %in% filter.pars,]
theta.warts.plot.pc3$variable <- as.character(theta.warts.plot.pc3$variable)
theta.warts.plot.pc3 <- theta.warts.plot.pc3[!is.na(theta.warts.plot.pc3$value),]
theta.warts.plot.pc3 <- theta.warts.plot.pc3[theta.warts.plot.pc3$value >= -10 & theta.warts.plot.pc3$value <= 10, ]

alpha.warts.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "warts")
alpha.warts.plot.pc3 <- alpha.warts.plot.pc3[alpha.warts.plot.pc3$variable %in% filter.pars,]
alpha.warts.plot.pc3$variable <- as.character(alpha.warts.plot.pc3$variable)
alpha.warts.plot.pc3 <- alpha.warts.plot.pc3[!is.na(alpha.warts.plot.pc3$value),]
alpha.warts.plot.pc3 <- alpha.warts.plot.pc3[alpha.warts.plot.pc3$value >= -10 & alpha.warts.plot.pc3$value <= 10, ]

sigma.warts.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "warts")
sigma.warts.plot.pc3 <- sigma.warts.plot.pc3[sigma.warts.plot.pc3$variable %in% filter.pars,]
sigma.warts.plot.pc3$variable <- as.character(sigma.warts.plot.pc3$variable)
sigma.warts.plot.pc3 <- sigma.warts.plot.pc3[!is.na(sigma.warts.plot.pc3$value),]
sigma.warts.plot.pc3 <- sigma.warts.plot.pc3[sigma.warts.plot.pc3$value >= -10 & sigma.warts.plot.pc3$value <= 10, ]

theta.warts.pc3 <-
    ggplot(na.omit(theta.warts.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.warts.pc3 <-
    ggplot(na.omit(alpha.warts.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.warts.pc3 <-
    ggplot(na.omit(sigma.warts.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.warts.pc3 + alpha.warts.pc3 + sigma.warts.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_warts_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.theta.pc3.", gsub(" ", ".", agg.warts.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_warts_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.alpha.pc3.", gsub(" ", ".", agg.warts.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_warts_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.sigma.pc3.", gsub(" ", ".", agg.warts.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```




# Hole Diameter - Discrete

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_holediam.disc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.holediam.disc)), rep(1:length(states.holediam.disc), 3))

theta.holediam.disc.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "holediam.disc")
theta.holediam.disc.plot.pc1 <- theta.holediam.disc.plot.pc1[theta.holediam.disc.plot.pc1$variable %in% filter.pars,]
theta.holediam.disc.plot.pc1$variable <- as.character(theta.holediam.disc.plot.pc1$variable)
theta.holediam.disc.plot.pc1 <- theta.holediam.disc.plot.pc1[!is.na(theta.holediam.disc.plot.pc1$value),]
theta.holediam.disc.plot.pc1 <- theta.holediam.disc.plot.pc1[theta.holediam.disc.plot.pc1$value >= -10 & theta.holediam.disc.plot.pc1$value <= 10, ]

alpha.holediam.disc.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "holediam.disc")
alpha.holediam.disc.plot.pc1 <- alpha.holediam.disc.plot.pc1[alpha.holediam.disc.plot.pc1$variable %in% filter.pars,]
alpha.holediam.disc.plot.pc1$variable <- as.character(alpha.holediam.disc.plot.pc1$variable)
alpha.holediam.disc.plot.pc1 <- alpha.holediam.disc.plot.pc1[!is.na(alpha.holediam.disc.plot.pc1$value),]
alpha.holediam.disc.plot.pc1 <- alpha.holediam.disc.plot.pc1[alpha.holediam.disc.plot.pc1$value >= -10 & alpha.holediam.disc.plot.pc1$value <= 10, ]

sigma.holediam.disc.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "holediam.disc")
sigma.holediam.disc.plot.pc1 <- sigma.holediam.disc.plot.pc1[sigma.holediam.disc.plot.pc1$variable %in% filter.pars,]
sigma.holediam.disc.plot.pc1$variable <- as.character(sigma.holediam.disc.plot.pc1$variable)
sigma.holediam.disc.plot.pc1 <- sigma.holediam.disc.plot.pc1[!is.na(sigma.holediam.disc.plot.pc1$value),]
sigma.holediam.disc.plot.pc1 <- sigma.holediam.disc.plot.pc1[sigma.holediam.disc.plot.pc1$value >= -10 & sigma.holediam.disc.plot.pc1$value <= 10, ]

theta.holediam.disc.pc1 <-
    ggplot(na.omit(theta.holediam.disc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

alpha.holediam.disc.pc1 <-
    ggplot(na.omit(alpha.holediam.disc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

sigma.holediam.disc.pc1 <-
    ggplot(na.omit(sigma.holediam.disc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

(theta.holediam.disc.pc1 + alpha.holediam.disc.pc1 + sigma.holediam.disc.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_holediam.disc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.theta.pc1.", gsub(" ", ".", agg.holediam.disc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc1$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_holediam.disc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.alpha.pc1.", gsub(" ", ".", agg.holediam.disc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc1$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_holediam.disc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.sigma.pc1.", gsub(" ", ".", agg.holediam.disc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc1$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```





# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_holediam.disc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.holediam.disc)), rep(1:length(states.holediam.disc), 3))

theta.holediam.disc.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "holediam.disc")
theta.holediam.disc.plot.pc2 <- theta.holediam.disc.plot.pc2[theta.holediam.disc.plot.pc2$variable %in% filter.pars,]
theta.holediam.disc.plot.pc2$variable <- as.character(theta.holediam.disc.plot.pc2$variable)
theta.holediam.disc.plot.pc2 <- theta.holediam.disc.plot.pc2[!is.na(theta.holediam.disc.plot.pc2$value),]
theta.holediam.disc.plot.pc2 <- theta.holediam.disc.plot.pc2[theta.holediam.disc.plot.pc2$value >= -10 & theta.holediam.disc.plot.pc2$value <= 10, ]

alpha.holediam.disc.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "holediam.disc")
alpha.holediam.disc.plot.pc2 <- alpha.holediam.disc.plot.pc2[alpha.holediam.disc.plot.pc2$variable %in% filter.pars,]
alpha.holediam.disc.plot.pc2$variable <- as.character(alpha.holediam.disc.plot.pc2$variable)
alpha.holediam.disc.plot.pc2 <- alpha.holediam.disc.plot.pc2[!is.na(alpha.holediam.disc.plot.pc2$value),]
alpha.holediam.disc.plot.pc2 <- alpha.holediam.disc.plot.pc2[alpha.holediam.disc.plot.pc2$value >= -10 & alpha.holediam.disc.plot.pc2$value <= 10, ]

sigma.holediam.disc.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "holediam.disc")
sigma.holediam.disc.plot.pc2 <- sigma.holediam.disc.plot.pc2[sigma.holediam.disc.plot.pc2$variable %in% filter.pars,]
sigma.holediam.disc.plot.pc2$variable <- as.character(sigma.holediam.disc.plot.pc2$variable)
sigma.holediam.disc.plot.pc2 <- sigma.holediam.disc.plot.pc2[!is.na(sigma.holediam.disc.plot.pc2$value),]
sigma.holediam.disc.plot.pc2 <- sigma.holediam.disc.plot.pc2[sigma.holediam.disc.plot.pc2$value >= -10 & sigma.holediam.disc.plot.pc2$value <= 10, ]

theta.holediam.disc.pc2 <-
    ggplot(na.omit(theta.holediam.disc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

alpha.holediam.disc.pc2 <-
    ggplot(na.omit(alpha.holediam.disc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

sigma.holediam.disc.pc2 <-
    ggplot(na.omit(sigma.holediam.disc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

(theta.holediam.disc.pc2 + alpha.holediam.disc.pc2 + sigma.holediam.disc.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_holediam.disc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.theta.pc2.", gsub(" ", ".", agg.holediam.disc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc2$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc2$Group.1)))))

```

```{r diffs_alpha_ouwie_holediam.disc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.alpha.pc2.", gsub(" ", ".", agg.holediam.disc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc2$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc2$Group.1)))))

```

```{r diffs_sigma_ouwie_holediam.disc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.sigma.pc2.", gsub(" ", ".", agg.holediam.disc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc2$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc2$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```





# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_holediam.disc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete."}

filter.pars <- paste0(rep(c("alpha", "sigma", "theta"), each = length(states.holediam.disc)), rep(1:length(states.holediam.disc), 3))

theta.holediam.disc.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "holediam.disc")
theta.holediam.disc.plot.pc3 <- theta.holediam.disc.plot.pc3[theta.holediam.disc.plot.pc3$variable %in% filter.pars,]
theta.holediam.disc.plot.pc3$variable <- as.character(theta.holediam.disc.plot.pc3$variable)
theta.holediam.disc.plot.pc3 <- theta.holediam.disc.plot.pc3[!is.na(theta.holediam.disc.plot.pc3$value),]
theta.holediam.disc.plot.pc3 <- theta.holediam.disc.plot.pc3[theta.holediam.disc.plot.pc3$value >= -10 & theta.holediam.disc.plot.pc3$value <= 10, ]

alpha.holediam.disc.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "holediam.disc")
alpha.holediam.disc.plot.pc3 <- alpha.holediam.disc.plot.pc3[alpha.holediam.disc.plot.pc3$variable %in% filter.pars,]
alpha.holediam.disc.plot.pc3$variable <- as.character(alpha.holediam.disc.plot.pc3$variable)
alpha.holediam.disc.plot.pc3 <- alpha.holediam.disc.plot.pc3[!is.na(alpha.holediam.disc.plot.pc3$value),]
alpha.holediam.disc.plot.pc3 <- alpha.holediam.disc.plot.pc3[alpha.holediam.disc.plot.pc3$value >= -10 & alpha.holediam.disc.plot.pc3$value <= 10, ]

sigma.holediam.disc.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "holediam.disc")
sigma.holediam.disc.plot.pc3 <- sigma.holediam.disc.plot.pc3[sigma.holediam.disc.plot.pc3$variable %in% filter.pars,]
sigma.holediam.disc.plot.pc3$variable <- as.character(sigma.holediam.disc.plot.pc3$variable)
sigma.holediam.disc.plot.pc3 <- sigma.holediam.disc.plot.pc3[!is.na(sigma.holediam.disc.plot.pc3$value),]
sigma.holediam.disc.plot.pc3 <- sigma.holediam.disc.plot.pc3[sigma.holediam.disc.plot.pc3$value >= -10 & sigma.holediam.disc.plot.pc3$value <= 10, ]

theta.holediam.disc.pc3 <-
    ggplot(na.omit(theta.holediam.disc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

alpha.holediam.disc.pc3 <-
    ggplot(na.omit(alpha.holediam.disc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

sigma.holediam.disc.pc3 <-
    ggplot(na.omit(sigma.holediam.disc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

(theta.holediam.disc.pc3 + alpha.holediam.disc.pc3 + sigma.holediam.disc.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_holediam.disc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.theta.pc3.", gsub(" ", ".", agg.holediam.disc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc3$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc3$Group.1)))))

```

```{r diffs_alpha_ouwie_holediam.disc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.alpha.pc3.", gsub(" ", ".", agg.holediam.disc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc3$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc3$Group.1)))))

```

```{r diffs_sigma_ouwie_holediam.disc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.sigma.pc3.", gsub(" ", ".", agg.holediam.disc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 150 replicas, orange cells highlight cases between 125 and 150 replicas, and yellow cells highlight cases between 100 and 125 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc3$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc3$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

---
author: Guillaume Chomicki1*, Gustavo Burin2, Toby ??, Susanne S. Renner3
title: The effects of mutualism on trait evolution - Residuals from ClimPC
output:
  pdf_document:
    toc: true
    latex_engine: lualatex
    keep_tex: true
  html_document:
    toc: true
    toc_float: true
header-includes:
  - \usepackage{pdflscape}
classoption: 
  - table
  - dvipsnames
---

Submitted to Ecology Letters, Evolution or Evolution Letters – well let’s see what we find!

Affiliations: 1Department of Bioscience, Durham University, Stockton Rd., Durham DH1 3LE, UK. 2University of Sao Paulo, xxxxx. 3Systematic Botany and Mycology, Department of Biology, University of Munich (LMU), Menzinger Str. 67, 80638 Munich, Germany.

Correspondence: *guillaume.chomicki@durham.ac.uk

# Analyses accounting for climate

The results below follow the same rationale as the ones from the main document. However, in the cases below all analyses use the plant traits already accounted for climatic effects by using the residuals from the regressions between each trait and the first three Principal Components of the climatic variables obtained from BioClim (REF).

\newpage

# Methods

```{r setup, eval = TRUE, echo = FALSE}

here::i_am("manuscript/chomicki_et_al_climpc.Rmd")

## options(kableExtra.latex.load_packages = FALSE)

#source(here::here("R/tree_plots.R"))
library("knitr")
library("RColorBrewer")
library("kableExtra")
library("ggplot2")
library("tidyverse")
# load("../output/first_analysis.RData")
knitr::opts_chunk$set(fig.pos = "h", out.extra = "")
# source("../R/ouwie_summary_mcc.R")
pars.table.pc1 <- read.csv(here::here("output/fullpar_table_climpc1_new.csv"))
pars.table.pc1$trait <- c("Stem Area", "Leaf Area", "Corola Length", "Petiole Length", "Hole Diameter")[match(pars.table.pc1$trait, c("stemarea", "leafarea", "corleng", "petleng", "holediam"))]
pars.table.pc1.clean <- pars.table.pc1[apply(pars.table.pc1[, grep("theta", names(pars.table.pc1))], 1, function(x){!any(x > 15, na.rm = TRUE)}),]
pars.table.pc1.clean <- pars.table.pc1.clean[apply(pars.table.pc1.clean[, grep("theta", names(pars.table.pc1.clean))], 1, function(x){!any(x < -15, na.rm = TRUE)}),]
pars.table.pc1 <- pars.table.pc1.clean

pars.table.pc2 <- read.csv(here::here("output/fullpar_table_climpc2_new.csv"))
pars.table.pc2$trait <- c("Stem Area", "Leaf Area", "Corola Length", "Petiole Lengzth", "Hole Diameter")[match(pars.table.pc2$trait, c("stemarea", "leafarea", "corleng", "petleng", "holediam"))]
pars.table.pc2.clean <- pars.table.pc2[apply(pars.table.pc2[, grep("theta", names(pars.table.pc2))], 1, function(x){!any(x > 15, na.rm = TRUE)}),]
pars.table.pc2.clean <- pars.table.pc2.clean[apply(pars.table.pc2.clean[, grep("theta", names(pars.table.pc2.clean))], 1, function(x){!any(x < -15, na.rm = TRUE)}),]
pars.table.pc2 <- pars.table.pc2.clean

pars.table.pc3 <- read.csv(here::here("output/fullpar_table_climpc3_new.csv"))
pars.table.pc3$trait <- c("Stem Area", "Leaf Area", "Corola Length", "Petiole Length", "Hole Diameter")[match(pars.table.pc3$trait, c("stemarea", "leafarea", "corleng", "petleng", "holediam"))]
pars.table.pc3.clean <- pars.table.pc3[apply(pars.table.pc3[, grep("theta", names(pars.table.pc3))], 1, function(x){!any(x > 15, na.rm = TRUE)}),]
pars.table.pc3.clean <- pars.table.pc3.clean[apply(pars.table.pc3.clean[, grep("theta", names(pars.table.pc3.clean))], 1, function(x){!any(x < -15, na.rm = TRUE)}),]
pars.table.pc3 <- pars.table.pc3.clean

colors <- setNames(brewer.pal(4, "Set1"), 1:4)
sig.formatter <- function(x){cell_spec(x, format = "latex", bold = ifelse(x > 50, TRUE, FALSE), background = if(x >= 90){"ForestGreen"} else if(x < 90 & x >= 75){"Peach"} else if(x < 75 & x >= 50){"Goldenrod"})}

```

# MCC tree

- 1000 reconstructions of each discrete trait (namely Mutualistic Strategy, Presence of Warts, Presence of Reward, Plant Architecture, Domatium growth type, Mating System, Leaf Structure and Presence of appendages)
- Sampled 100 reconstructions and performed continuous trait evolution analysis (Stem Area, Leaf Area, Corolla Length and Petiole Length) using residuals of correlations between continuous traits and the first 3 climatic PCs.
- Fitted 7 models:
  - Single-rate Brownian Motion (BM1 - 1 parameter)
  - Multiple-rate Brownian Motion (BMS - 3 parameters)
  - Simple OU (OU1 - 3 parameters)
  - OU with different optima but same alpha and sigma (OUM - 5 parameters)
  - OU with different optima and alpha but same sigma (OUMA - 7 parameters)
  - OU with different optima and sigma but same alpha (OUMV - 7 parameters)
  - OU with different optima, alpha, and sigma (OUMVA - 9 parameters)

# Summary of Results

Due to the elevated number of variables and models, we opted to use a model averaging approach by calculating the weighted average of parameter values. The final value of each parameter was calculated by multiplying the estimated value for a given parameter in a given model by the Akaike weight of the given model. Thus, we need not resort to any arbitrary criterium (such as $\delta$AIC > 2) and can evaluate the dynamics solely based on the parameter values. All plots below were filtered to exclude parameter values that were larger than -10 ($e^-10$) and smaller than 10 ($e^10$), on the justification of representing bad fitting or unreasonable biological meaning.

## Residuals from climatic PCs

Most tested correlations between each continuous trait and the climatic PC were non-significant regardless of accounting or not for the phylogenetic structuring of the residuals. The only trait that showed significant correlations to both climatic PC1 and PC2 was "Hole Diameter", and therefore will be the only trait for which we will consider the parameter values for both climatic PCs. For practical purposes, the results for all PCs should be virtually identical for all other continuous traits, and therefore we will only analyse the results for the PC1.


## Appendages

Species with "variable" appendages show increased $\theta$ values for corola length, leaf area, petiole length and stem area when compared to the other states.

Species with "spines" have intermediate $\theta$ values for petiole length and stem area.

On the other hand, species with no appendages undergo stronger selection for hole diameter (for both PC1 and PC2), leaf area, and stem area when compared to other states, with also faster evolutionary rates for corola length, petiole length and stem area. 

Species with "variable" appendages undergo intermediate selection for leaf and stem area when compared to other states.

## Architecture

Species with single stems evolve towards higher $\theta$ values for all traits. Conversely, species with multiple stems show higher high $\alpha$ values for corola length, hole diameter (for both PC1 and PC2), leaf area and petiole length, but not for stem area. Also, $\sigma^{2}$ is higher in species with multiple stems for all traits but hole diameter.

## Domatium Growth

Species with apical growth show higher $\theta$ values for corola length, leaf and stem area and petiole length. For $\alpha$ values, species with apical growth show higher values for corola length and stem area, whereas species with diffuse growth show higher values for hole diameter and petiole length. Regarding $\sigma^{2}$, species with diffuse growth show higher values for all traits.

Species with diffuse growth show higher values of both $\theta$, $\alpha$ and $\sigma^{2}$ for both PC1 and PC2.

## Leaf Structure

Species with thin leaves have higher values of $\theta$ for hole diameter, leaf area, and stem area, whereas species with variable leaf structure have higher values of corola length and petiole length. Species with thick leaves show higher $\alpha$ values for corola length, hole diameter and leaf area, and succulent species for petiole length and stem area.

For $\sigma^{2}$, species with succulent leaves have higher values for corola and petiole length, whereas species with thick leaves show higer values for leaf and stem area. 

## Mating System

All differences in parameters for mating system were discrete, being hard to find any pattern.

## Reward

Species that give rewards show higher $\theta$ values for all traits but hole diameter, for which the signal is mixed (both in PC1 and PC2). Also, these species show higher $\alpha$ values for all traits, and higher $\sigma^{2}$ for all traits but hole diameter (both in PC1 and PC2).

## Strategy

Species that are obligate mutualistics show higer values of $\theta$ for all traits but hole diameter, for which species that lost this interaction have higher hole diameters than other species for PC1, and the facultative ones for PC2. On the other hand, species that are facultatively mutialistic show higher $\alpha$ values for corola length, hole diameter (for both PC1 and PC2) and petiole length, whereas for leaf area the higher $\alpha$ values are from species who lost this interaction, and for stem area the higher are obligate mutualists.

For $\sigma^{2}$, facultative species show higher values for all traits but leaf area, for which species that lost the interaction show higher values.

## Warts

Species with differentiated warts have higher $\theta$ and $\sigma^{2}$ values for all traits but hole diameter, for which higher values belong to species that lost this structure (whereas for PC2 higher values are for species with variable warts). For $\alpha$, species with variable warts show higher values for hole diameter and petiole length, whereas species who lost these structures show higher values for leaf and stem area.

\newpage

# Figures and tables

```{r pars_ouwie_setup, echo = FALSE, message = FALSE, warning = FALSE}

library("cowplot")
library("patchwork")

data.plot.pc1 <- reshape2::melt(pars.table.pc1, id.vars = c("trait", "disc.trait", "simmap"))
theta.plot.pc1 <- data.plot.pc1[grep("theta", data.plot.pc1$variable),]
alpha.plot.pc1 <- data.plot.pc1[grep("alpha", data.plot.pc1$variable),]
sigma.plot.pc1 <- data.plot.pc1[grep("sigma", data.plot.pc1$variable),]

data.plot.pc2 <- reshape2::melt(pars.table.pc2, id.vars = c("trait", "disc.trait", "simmap"))
theta.plot.pc2 <- data.plot.pc2[grep("theta", data.plot.pc2$variable),]
alpha.plot.pc2 <- data.plot.pc2[grep("alpha", data.plot.pc2$variable),]
sigma.plot.pc2 <- data.plot.pc2[grep("sigma", data.plot.pc2$variable),]

data.plot.pc3 <- reshape2::melt(pars.table.pc3, id.vars = c("trait", "disc.trait", "simmap"))
theta.plot.pc3 <- data.plot.pc3[grep("theta", data.plot.pc3$variable),]
alpha.plot.pc3 <- data.plot.pc3[grep("alpha", data.plot.pc3$variable),]
sigma.plot.pc3 <- data.plot.pc3[grep("sigma", data.plot.pc3$variable),]

source(here::here("R/data_prep_ouwie_climpc.R"))

```

# Appendages

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_app_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage."}

theta.app.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "app")
theta.app.plot.pc1$variable <- as.character(theta.app.plot.pc1$variable)
theta.app.plot.pc1 <- theta.app.plot.pc1[theta.app.plot.pc1$variable %in% paste0("theta", 1:length(states.app)), ]

alpha.app.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "app")
alpha.app.plot.pc1$variable <- as.character(alpha.app.plot.pc1$variable)
alpha.app.plot.pc1 <- alpha.app.plot.pc1[alpha.app.plot.pc1$variable %in% paste0("alpha", 1:length(states.app)), ]

sigma.app.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "app")
sigma.app.plot.pc1$variable <- as.character(sigma.app.plot.pc1$variable)
sigma.app.plot.pc1 <- sigma.app.plot.pc1[sigma.app.plot.pc1$variable %in% paste0("sigma", 1:length(states.app)), ]

theta.app.pc1 <-
    ggplot(na.omit(theta.app.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.app.pc1 <-
    ggplot(na.omit(alpha.app.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.app.pc1 <-
    ggplot(na.omit(sigma.app.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.app.pc1 + alpha.app.pc1 + sigma.app.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_app_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.theta.pc1.", gsub(" ", ".", agg.app.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_app_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.alpha.pc1.", gsub(" ", ".", agg.app.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_app_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.sigma.pc1.", gsub(" ", ".", agg.app.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_app_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage."}

theta.app.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "app")
theta.app.plot.pc2$variable <- as.character(theta.app.plot.pc2$variable)
theta.app.plot.pc2 <- theta.app.plot.pc2[theta.app.plot.pc2$variable %in% paste0("theta", 1:length(states.app)), ]

alpha.app.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "app")
alpha.app.plot.pc2$variable <- as.character(alpha.app.plot.pc2$variable)
alpha.app.plot.pc2 <- alpha.app.plot.pc2[alpha.app.plot.pc2$variable %in% paste0("alpha", 1:length(states.app)), ]

sigma.app.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "app")
sigma.app.plot.pc2$variable <- as.character(sigma.app.plot.pc2$variable)
sigma.app.plot.pc2 <- sigma.app.plot.pc2[sigma.app.plot.pc2$variable %in% paste0("sigma", 1:length(states.app)), ]

theta.app.pc2 <-
    ggplot(na.omit(theta.app.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.app.pc2 <-
    ggplot(na.omit(alpha.app.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.app.pc2 <-
    ggplot(na.omit(sigma.app.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.app.pc2 + alpha.app.pc2 + sigma.app.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_app_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.theta.pc2.", gsub(" ", ".", agg.app.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_app_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.alpha.pc2.", gsub(" ", ".", agg.app.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_app_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.sigma.pc2.", gsub(" ", ".", agg.app.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_app_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage."}

theta.app.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "app")
theta.app.plot.pc3$variable <- as.character(theta.app.plot.pc3$variable)
theta.app.plot.pc3 <- theta.app.plot.pc3[theta.app.plot.pc3$variable %in% paste0("theta", 1:length(states.app)), ]

alpha.app.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "app")
alpha.app.plot.pc3$variable <- as.character(alpha.app.plot.pc3$variable)
alpha.app.plot.pc3 <- alpha.app.plot.pc3[alpha.app.plot.pc3$variable %in% paste0("alpha", 1:length(states.app)), ]

sigma.app.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "app")
sigma.app.plot.pc3$variable <- as.character(sigma.app.plot.pc3$variable)
sigma.app.plot.pc3 <- sigma.app.plot.pc3[sigma.app.plot.pc3$variable %in% paste0("sigma", 1:length(states.app)), ]

theta.app.pc3 <-
    ggplot(na.omit(theta.app.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.app.pc3 <-
    ggplot(na.omit(alpha.app.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.app.pc3 <-
    ggplot(na.omit(sigma.app.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.app) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.app.pc3 + alpha.app.pc3 + sigma.app.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_app_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.theta.pc3.", gsub(" ", ".", agg.app.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))
```

```{r diffs_alpha_ouwie_app_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.alpha.pc3.", gsub(" ", ".", agg.app.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_app_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Appendage. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("app.diff.sigma.pc3.", gsub(" ", ".", agg.app.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Appendages. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.app, length(agg.app.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.app.diff.pc1$Group.1), c(1, rep(length(states.app), length(agg.app.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```






# Architecture

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_arch_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture."}

theta.arch.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "arch")
theta.arch.plot.pc1$variable <- as.character(theta.arch.plot.pc1$variable)
theta.arch.plot.pc1 <- theta.arch.plot.pc1[theta.arch.plot.pc1$variable %in% paste0("theta", 1:length(states.arch)), ]

alpha.arch.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "arch")
alpha.arch.plot.pc1$variable <- as.character(alpha.arch.plot.pc1$variable)
alpha.arch.plot.pc1 <- alpha.arch.plot.pc1[alpha.arch.plot.pc1$variable %in% paste0("alpha", 1:length(states.arch)), ]

sigma.arch.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "arch")
sigma.arch.plot.pc1$variable <- as.character(sigma.arch.plot.pc1$variable)
sigma.arch.plot.pc1 <- sigma.arch.plot.pc1[sigma.arch.plot.pc1$variable %in% paste0("sigma", 1:length(states.arch)), ]

theta.arch.pc1 <-
    ggplot(na.omit(theta.arch.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.arch.pc1 <-
    ggplot(na.omit(alpha.arch.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.arch.pc1 <-
    ggplot(na.omit(sigma.arch.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.arch.pc1 + alpha.arch.pc1 + sigma.arch.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_arch_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.theta.pc1.", gsub(" ", ".", agg.arch.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_arch_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.alpha.pc1.", gsub(" ", ".", agg.arch.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_arch_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.sigma.pc1.", gsub(" ", ".", agg.arch.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_arch_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture."}

theta.arch.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "arch")
theta.arch.plot.pc2$variable <- as.character(theta.arch.plot.pc2$variable)
theta.arch.plot.pc2 <- theta.arch.plot.pc2[theta.arch.plot.pc2$variable %in% paste0("theta", 1:length(states.arch)), ]

alpha.arch.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "arch")
alpha.arch.plot.pc2$variable <- as.character(alpha.arch.plot.pc2$variable)
alpha.arch.plot.pc2 <- alpha.arch.plot.pc2[alpha.arch.plot.pc2$variable %in% paste0("alpha", 1:length(states.arch)), ]

sigma.arch.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "arch")
sigma.arch.plot.pc2$variable <- as.character(sigma.arch.plot.pc2$variable)
sigma.arch.plot.pc2 <- sigma.arch.plot.pc2[sigma.arch.plot.pc2$variable %in% paste0("sigma", 1:length(states.arch)), ]

theta.arch.pc2 <-
    ggplot(na.omit(theta.arch.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.arch.pc2 <-
    ggplot(na.omit(alpha.arch.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.arch.pc2 <-
    ggplot(na.omit(sigma.arch.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.arch.pc2 + alpha.arch.pc2 + sigma.arch.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_arch_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.theta.pc2.", gsub(" ", ".", agg.arch.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_arch_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.alpha.pc2.", gsub(" ", ".", agg.arch.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_arch_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.sigma.pc2.", gsub(" ", ".", agg.arch.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_arch_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture."}

theta.arch.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "arch")
theta.arch.plot.pc3$variable <- as.character(theta.arch.plot.pc3$variable)
theta.arch.plot.pc3 <- theta.arch.plot.pc3[theta.arch.plot.pc3$variable %in% paste0("theta", 1:length(states.arch)), ]

alpha.arch.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "arch")
alpha.arch.plot.pc3$variable <- as.character(alpha.arch.plot.pc3$variable)
alpha.arch.plot.pc3 <- alpha.arch.plot.pc3[alpha.arch.plot.pc3$variable %in% paste0("alpha", 1:length(states.arch)), ]

sigma.arch.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "arch")
sigma.arch.plot.pc3$variable <- as.character(sigma.arch.plot.pc3$variable)
sigma.arch.plot.pc3 <- sigma.arch.plot.pc3[sigma.arch.plot.pc3$variable %in% paste0("sigma", 1:length(states.arch)), ]

theta.arch.pc3 <-
    ggplot(na.omit(theta.arch.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.arch.pc3 <-
    ggplot(na.omit(alpha.arch.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.arch.pc3 <-
    ggplot(na.omit(sigma.arch.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.arch) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.arch.pc3 + alpha.arch.pc3 + sigma.arch.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_arch_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.theta.pc3.", gsub(" ", ".", agg.arch.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_arch_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.alpha.pc3.", gsub(" ", ".", agg.arch.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_arch_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Architecture. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("arch.diff.sigma.pc3.", gsub(" ", ".", agg.arch.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Architecture. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.arch, length(agg.arch.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.arch.diff.pc1$Group.1), c(1, rep(length(states.arch), length(agg.arch.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```







# Domatium Growth

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_domgrow_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth."}

theta.domgrow.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "domgrow")
theta.domgrow.plot.pc1$variable <- as.character(theta.domgrow.plot.pc1$variable)
theta.domgrow.plot.pc1 <- theta.domgrow.plot.pc1[theta.domgrow.plot.pc1$variable %in% paste0("theta", 1:length(states.domgrow)), ]

alpha.domgrow.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "domgrow")
alpha.domgrow.plot.pc1$variable <- as.character(alpha.domgrow.plot.pc1$variable)
alpha.domgrow.plot.pc1 <- alpha.domgrow.plot.pc1[alpha.domgrow.plot.pc1$variable %in% paste0("alpha", 1:length(states.domgrow)), ]

sigma.domgrow.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "domgrow")
sigma.domgrow.plot.pc1$variable <- as.character(sigma.domgrow.plot.pc1$variable)
sigma.domgrow.plot.pc1 <- sigma.domgrow.plot.pc1[sigma.domgrow.plot.pc1$variable %in% paste0("sigma", 1:length(states.domgrow)), ]

theta.domgrow.pc1 <-
    ggplot(na.omit(theta.domgrow.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.domgrow.pc1 <-
    ggplot(na.omit(alpha.domgrow.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.domgrow.pc1 <-
    ggplot(na.omit(sigma.domgrow.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.domgrow.pc1 + alpha.domgrow.pc1 + sigma.domgrow.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_domgrow_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.theta.pc1.", gsub(" ", ".", agg.domgrow.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_domgrow_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.alpha.pc1.", gsub(" ", ".", agg.domgrow.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_domgrow_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.sigma.pc1.", gsub(" ", ".", agg.domgrow.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_domgrow_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth."}

theta.domgrow.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "domgrow")
theta.domgrow.plot.pc2$variable <- as.character(theta.domgrow.plot.pc2$variable)
theta.domgrow.plot.pc2 <- theta.domgrow.plot.pc2[theta.domgrow.plot.pc2$variable %in% paste0("theta", 1:length(states.domgrow)), ]

alpha.domgrow.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "domgrow")
alpha.domgrow.plot.pc2$variable <- as.character(alpha.domgrow.plot.pc2$variable)
alpha.domgrow.plot.pc2 <- alpha.domgrow.plot.pc2[alpha.domgrow.plot.pc2$variable %in% paste0("alpha", 1:length(states.domgrow)), ]

sigma.domgrow.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "domgrow")
sigma.domgrow.plot.pc2$variable <- as.character(sigma.domgrow.plot.pc2$variable)
sigma.domgrow.plot.pc2 <- sigma.domgrow.plot.pc2[sigma.domgrow.plot.pc2$variable %in% paste0("sigma", 1:length(states.domgrow)), ]

theta.domgrow.pc2 <-
    ggplot(na.omit(theta.domgrow.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.domgrow.pc2 <-
    ggplot(na.omit(alpha.domgrow.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.domgrow.pc2 <-
    ggplot(na.omit(sigma.domgrow.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.domgrow.pc2 + alpha.domgrow.pc2 + sigma.domgrow.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_domgrow_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.theta.pc2.", gsub(" ", ".", agg.domgrow.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_domgrow_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.alpha.pc2.", gsub(" ", ".", agg.domgrow.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_domgrow_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.sigma.pc2.", gsub(" ", ".", agg.domgrow.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_domgrow_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth."}

theta.domgrow.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "domgrow")
theta.domgrow.plot.pc3$variable <- as.character(theta.domgrow.plot.pc3$variable)
theta.domgrow.plot.pc3 <- theta.domgrow.plot.pc3[theta.domgrow.plot.pc3$variable %in% paste0("theta", 1:length(states.domgrow)), ]

alpha.domgrow.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "domgrow")
alpha.domgrow.plot.pc3$variable <- as.character(alpha.domgrow.plot.pc3$variable)
alpha.domgrow.plot.pc3 <- alpha.domgrow.plot.pc3[alpha.domgrow.plot.pc3$variable %in% paste0("alpha", 1:length(states.domgrow)), ]

sigma.domgrow.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "domgrow")
sigma.domgrow.plot.pc3$variable <- as.character(sigma.domgrow.plot.pc3$variable)
sigma.domgrow.plot.pc3 <- sigma.domgrow.plot.pc3[sigma.domgrow.plot.pc3$variable %in% paste0("sigma", 1:length(states.domgrow)), ]

theta.domgrow.pc3 <-
    ggplot(na.omit(theta.domgrow.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.domgrow.pc3 <-
    ggplot(na.omit(alpha.domgrow.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.domgrow.pc3 <-
    ggplot(na.omit(sigma.domgrow.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.domgrow) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.domgrow.pc3 + alpha.domgrow.pc3 + sigma.domgrow.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_domgrow_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.theta.pc3.", gsub(" ", ".", agg.domgrow.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_domgrow_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.alpha.pc3.", gsub(" ", ".", agg.domgrow.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_domgrow_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Domatium Growth. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("domgrow.diff.sigma.pc3.", gsub(" ", ".", agg.domgrow.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Domatium Growth. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.domgrow, length(agg.domgrow.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.domgrow.diff.pc1$Group.1), c(1, rep(length(states.domgrow), length(agg.domgrow.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```






# Leaf Structure

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_leafstruc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure."}

theta.leafstruc.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "leafstruc")
theta.leafstruc.plot.pc1$variable <- as.character(theta.leafstruc.plot.pc1$variable)
theta.leafstruc.plot.pc1 <- theta.leafstruc.plot.pc1[theta.leafstruc.plot.pc1$variable %in% paste0("theta", 1:length(states.leafstruc)), ]

alpha.leafstruc.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "leafstruc")
alpha.leafstruc.plot.pc1$variable <- as.character(alpha.leafstruc.plot.pc1$variable)
alpha.leafstruc.plot.pc1 <- alpha.leafstruc.plot.pc1[alpha.leafstruc.plot.pc1$variable %in% paste0("alpha", 1:length(states.leafstruc)), ]

sigma.leafstruc.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "leafstruc")
sigma.leafstruc.plot.pc1$variable <- as.character(sigma.leafstruc.plot.pc1$variable)
sigma.leafstruc.plot.pc1 <- sigma.leafstruc.plot.pc1[sigma.leafstruc.plot.pc1$variable %in% paste0("sigma", 1:length(states.leafstruc)), ]

theta.leafstruc.pc1 <-
    ggplot(na.omit(theta.leafstruc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.leafstruc.pc1 <-
    ggplot(na.omit(alpha.leafstruc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.leafstruc.pc1 <-
    ggplot(na.omit(sigma.leafstruc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.leafstruc.pc1 + alpha.leafstruc.pc1 + sigma.leafstruc.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_leafstruc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.theta.pc1.", gsub(" ", ".", agg.leafstruc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_leafstruc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.alpha.pc1.", gsub(" ", ".", agg.leafstruc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_leafstruc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.sigma.pc1.", gsub(" ", ".", agg.leafstruc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_leafstruc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure."}

theta.leafstruc.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "leafstruc")
theta.leafstruc.plot.pc2$variable <- as.character(theta.leafstruc.plot.pc2$variable)
theta.leafstruc.plot.pc2 <- theta.leafstruc.plot.pc2[theta.leafstruc.plot.pc2$variable %in% paste0("theta", 1:length(states.leafstruc)), ]

alpha.leafstruc.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "leafstruc")
alpha.leafstruc.plot.pc2$variable <- as.character(alpha.leafstruc.plot.pc2$variable)
alpha.leafstruc.plot.pc2 <- alpha.leafstruc.plot.pc2[alpha.leafstruc.plot.pc2$variable %in% paste0("alpha", 1:length(states.leafstruc)), ]

sigma.leafstruc.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "leafstruc")
sigma.leafstruc.plot.pc2$variable <- as.character(sigma.leafstruc.plot.pc2$variable)
sigma.leafstruc.plot.pc2 <- sigma.leafstruc.plot.pc2[sigma.leafstruc.plot.pc2$variable %in% paste0("sigma", 1:length(states.leafstruc)), ]

theta.leafstruc.pc2 <-
    ggplot(na.omit(theta.leafstruc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.leafstruc.pc2 <-
    ggplot(na.omit(alpha.leafstruc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.leafstruc.pc2 <-
    ggplot(na.omit(sigma.leafstruc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.leafstruc.pc2 + alpha.leafstruc.pc2 + sigma.leafstruc.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_leafstruc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.theta.pc2.", gsub(" ", ".", agg.leafstruc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_leafstruc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.alpha.pc2.", gsub(" ", ".", agg.leafstruc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_leafstruc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.sigma.pc2.", gsub(" ", ".", agg.leafstruc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_leafstruc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure."}

theta.leafstruc.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "leafstruc")
theta.leafstruc.plot.pc3$variable <- as.character(theta.leafstruc.plot.pc3$variable)
theta.leafstruc.plot.pc3 <- theta.leafstruc.plot.pc3[theta.leafstruc.plot.pc3$variable %in% paste0("theta", 1:length(states.leafstruc)), ]

alpha.leafstruc.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "leafstruc")
alpha.leafstruc.plot.pc3$variable <- as.character(alpha.leafstruc.plot.pc3$variable)
alpha.leafstruc.plot.pc3 <- alpha.leafstruc.plot.pc3[alpha.leafstruc.plot.pc3$variable %in% paste0("alpha", 1:length(states.leafstruc)), ]

sigma.leafstruc.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "leafstruc")
sigma.leafstruc.plot.pc3$variable <- as.character(sigma.leafstruc.plot.pc3$variable)
sigma.leafstruc.plot.pc3 <- sigma.leafstruc.plot.pc3[sigma.leafstruc.plot.pc3$variable %in% paste0("sigma", 1:length(states.leafstruc)), ]

theta.leafstruc.pc3 <-
    ggplot(na.omit(theta.leafstruc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.leafstruc.pc3 <-
    ggplot(na.omit(alpha.leafstruc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.leafstruc.pc3 <-
    ggplot(na.omit(sigma.leafstruc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.leafstruc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.leafstruc.pc3 + alpha.leafstruc.pc3 + sigma.leafstruc.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_leafstruc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.theta.pc3.", gsub(" ", ".", agg.leafstruc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_leafstruc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.alpha.pc3.", gsub(" ", ".", agg.leafstruc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_leafstruc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Leaf Structure. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("leafstruc.diff.sigma.pc3.", gsub(" ", ".", agg.leafstruc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Leaf Structure. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.leafstruc, length(agg.leafstruc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.leafstruc.diff.pc1$Group.1), c(1, rep(length(states.leafstruc), length(agg.leafstruc.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```






# Mating System

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_matsys_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System."}

theta.matsys.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "matsys")
theta.matsys.plot.pc1$variable <- as.character(theta.matsys.plot.pc1$variable)
theta.matsys.plot.pc1 <- theta.matsys.plot.pc1[theta.matsys.plot.pc1$variable %in% paste0("theta", 1:length(states.matsys)), ]

alpha.matsys.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "matsys")
alpha.matsys.plot.pc1$variable <- as.character(alpha.matsys.plot.pc1$variable)
alpha.matsys.plot.pc1 <- alpha.matsys.plot.pc1[alpha.matsys.plot.pc1$variable %in% paste0("alpha", 1:length(states.matsys)), ]

sigma.matsys.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "matsys")
sigma.matsys.plot.pc1$variable <- as.character(sigma.matsys.plot.pc1$variable)
sigma.matsys.plot.pc1 <- sigma.matsys.plot.pc1[sigma.matsys.plot.pc1$variable %in% paste0("sigma", 1:length(states.matsys)), ]

theta.matsys.pc1 <-
    ggplot(na.omit(theta.matsys.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.matsys.pc1 <-
    ggplot(na.omit(alpha.matsys.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.matsys.pc1 <-
    ggplot(na.omit(sigma.matsys.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.matsys.pc1 + alpha.matsys.pc1 + sigma.matsys.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_matsys_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.theta.pc1.", gsub(" ", ".", agg.matsys.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_matsys_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.alpha.pc1.", gsub(" ", ".", agg.matsys.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_matsys_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.sigma.pc1.", gsub(" ", ".", agg.matsys.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_matsys_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System."}

theta.matsys.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "matsys")
theta.matsys.plot.pc2$variable <- as.character(theta.matsys.plot.pc2$variable)
theta.matsys.plot.pc2 <- theta.matsys.plot.pc2[theta.matsys.plot.pc2$variable %in% paste0("theta", 1:length(states.matsys)), ]

alpha.matsys.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "matsys")
alpha.matsys.plot.pc2$variable <- as.character(alpha.matsys.plot.pc2$variable)
alpha.matsys.plot.pc2 <- alpha.matsys.plot.pc2[alpha.matsys.plot.pc2$variable %in% paste0("alpha", 1:length(states.matsys)), ]

sigma.matsys.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "matsys")
sigma.matsys.plot.pc2$variable <- as.character(sigma.matsys.plot.pc2$variable)
sigma.matsys.plot.pc2 <- sigma.matsys.plot.pc2[sigma.matsys.plot.pc2$variable %in% paste0("sigma", 1:length(states.matsys)), ]

theta.matsys.pc2 <-
    ggplot(na.omit(theta.matsys.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.matsys.pc2 <-
    ggplot(na.omit(alpha.matsys.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.matsys.pc2 <-
    ggplot(na.omit(sigma.matsys.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.matsys.pc2 + alpha.matsys.pc2 + sigma.matsys.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_matsys_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.theta.pc2.", gsub(" ", ".", agg.matsys.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_matsys_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.alpha.pc2.", gsub(" ", ".", agg.matsys.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_matsys_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.sigma.pc2.", gsub(" ", ".", agg.matsys.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_matsys_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System."}

theta.matsys.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "matsys")
theta.matsys.plot.pc3$variable <- as.character(theta.matsys.plot.pc3$variable)
theta.matsys.plot.pc3 <- theta.matsys.plot.pc3[theta.matsys.plot.pc3$variable %in% paste0("theta", 1:length(states.matsys)), ]

alpha.matsys.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "matsys")
alpha.matsys.plot.pc3$variable <- as.character(alpha.matsys.plot.pc3$variable)
alpha.matsys.plot.pc3 <- alpha.matsys.plot.pc3[alpha.matsys.plot.pc3$variable %in% paste0("alpha", 1:length(states.matsys)), ]

sigma.matsys.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "matsys")
sigma.matsys.plot.pc3$variable <- as.character(sigma.matsys.plot.pc3$variable)
sigma.matsys.plot.pc3 <- sigma.matsys.plot.pc3[sigma.matsys.plot.pc3$variable %in% paste0("sigma", 1:length(states.matsys)), ]

theta.matsys.pc3 <-
    ggplot(na.omit(theta.matsys.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.matsys.pc3 <-
    ggplot(na.omit(alpha.matsys.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.matsys.pc3 <-
    ggplot(na.omit(sigma.matsys.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.matsys) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.matsys.pc3 + alpha.matsys.pc3 + sigma.matsys.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_matsys_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.theta.pc3.", gsub(" ", ".", agg.matsys.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_matsys_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.alpha.pc3.", gsub(" ", ".", agg.matsys.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_matsys_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Mating System. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("matsys.diff.sigma.pc3.", gsub(" ", ".", agg.matsys.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Mating System. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.matsys, length(agg.matsys.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.matsys.diff.pc1$Group.1), c(1, rep(length(states.matsys), length(agg.matsys.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```






# Reward

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_reward_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward."}

theta.reward.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "reward")
theta.reward.plot.pc1$variable <- as.character(theta.reward.plot.pc1$variable)
theta.reward.plot.pc1 <- theta.reward.plot.pc1[theta.reward.plot.pc1$variable %in% paste0("theta", 1:length(states.reward)), ]

alpha.reward.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "reward")
alpha.reward.plot.pc1$variable <- as.character(alpha.reward.plot.pc1$variable)
alpha.reward.plot.pc1 <- alpha.reward.plot.pc1[alpha.reward.plot.pc1$variable %in% paste0("alpha", 1:length(states.reward)), ]

sigma.reward.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "reward")
sigma.reward.plot.pc1$variable <- as.character(sigma.reward.plot.pc1$variable)
sigma.reward.plot.pc1 <- sigma.reward.plot.pc1[sigma.reward.plot.pc1$variable %in% paste0("sigma", 1:length(states.reward)), ]

theta.reward.pc1 <-
    ggplot(na.omit(theta.reward.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.reward.pc1 <-
    ggplot(na.omit(alpha.reward.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.reward.pc1 <-
    ggplot(na.omit(sigma.reward.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.reward.pc1 + alpha.reward.pc1 + sigma.reward.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_reward_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.theta.pc1.", gsub(" ", ".", agg.reward.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_reward_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.alpha.pc1.", gsub(" ", ".", agg.reward.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_reward_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.sigma.pc1.", gsub(" ", ".", agg.reward.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameter

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r pars_ouwie_reward_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward."}

theta.reward.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "reward")
theta.reward.plot.pc2$variable <- as.character(theta.reward.plot.pc2$variable)
theta.reward.plot.pc2 <- theta.reward.plot.pc2[theta.reward.plot.pc2$variable %in% paste0("theta", 1:length(states.reward)), ]

alpha.reward.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "reward")
alpha.reward.plot.pc2$variable <- as.character(alpha.reward.plot.pc2$variable)
alpha.reward.plot.pc2 <- alpha.reward.plot.pc2[alpha.reward.plot.pc2$variable %in% paste0("alpha", 1:length(states.reward)), ]

sigma.reward.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "reward")
sigma.reward.plot.pc2$variable <- as.character(sigma.reward.plot.pc2$variable)
sigma.reward.plot.pc2 <- sigma.reward.plot.pc2[sigma.reward.plot.pc2$variable %in% paste0("sigma", 1:length(states.reward)), ]

theta.reward.pc2 <-
    ggplot(na.omit(theta.reward.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.reward.pc2 <-
    ggplot(na.omit(alpha.reward.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.reward.pc2 <-
    ggplot(na.omit(sigma.reward.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.reward.pc2 + alpha.reward.pc2 + sigma.reward.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_reward_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.theta.pc2.", gsub(" ", ".", agg.reward.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_reward_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.alpha.pc2.", gsub(" ", ".", agg.reward.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_reward_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.sigma.pc2.", gsub(" ", ".", agg.reward.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_reward_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward."}

theta.reward.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "reward")
theta.reward.plot.pc3$variable <- as.character(theta.reward.plot.pc3$variable)
theta.reward.plot.pc3 <- theta.reward.plot.pc3[theta.reward.plot.pc3$variable %in% paste0("theta", 1:length(states.reward)), ]

alpha.reward.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "reward")
alpha.reward.plot.pc3$variable <- as.character(alpha.reward.plot.pc3$variable)
alpha.reward.plot.pc3 <- alpha.reward.plot.pc3[alpha.reward.plot.pc3$variable %in% paste0("alpha", 1:length(states.reward)), ]

sigma.reward.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "reward")
sigma.reward.plot.pc3$variable <- as.character(sigma.reward.plot.pc3$variable)
sigma.reward.plot.pc3 <- sigma.reward.plot.pc3[sigma.reward.plot.pc3$variable %in% paste0("sigma", 1:length(states.reward)), ]

theta.reward.pc3 <-
    ggplot(na.omit(theta.reward.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.reward.pc3 <-
    ggplot(na.omit(alpha.reward.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.reward.pc3 <-
    ggplot(na.omit(sigma.reward.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.reward) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.reward.pc3 + alpha.reward.pc3 + sigma.reward.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_reward_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.theta.pc3.", gsub(" ", ".", agg.reward.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_reward_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.alpha.pc3.", gsub(" ", ".", agg.reward.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_reward_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Reward. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("reward.diff.sigma.pc3.", gsub(" ", ".", agg.reward.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Reward. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.reward, length(agg.reward.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.reward.diff.pc1$Group.1), c(1, rep(length(states.reward), length(agg.reward.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```





# Strategy

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_strategy_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy."}

theta.strategy.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "strategy")
theta.strategy.plot.pc1$variable <- as.character(theta.strategy.plot.pc1$variable)
theta.strategy.plot.pc1 <- theta.strategy.plot.pc1[theta.strategy.plot.pc1$variable %in% paste0("theta", 1:length(states.strategy)), ]

alpha.strategy.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "strategy")
alpha.strategy.plot.pc1$variable <- as.character(alpha.strategy.plot.pc1$variable)
alpha.strategy.plot.pc1 <- alpha.strategy.plot.pc1[alpha.strategy.plot.pc1$variable %in% paste0("alpha", 1:length(states.strategy)), ]

sigma.strategy.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "strategy")
sigma.strategy.plot.pc1$variable <- as.character(sigma.strategy.plot.pc1$variable)
sigma.strategy.plot.pc1 <- sigma.strategy.plot.pc1[sigma.strategy.plot.pc1$variable %in% paste0("sigma", 1:length(states.strategy)), ]

theta.strategy.pc1 <-
    ggplot(na.omit(theta.strategy.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.strategy.pc1 <-
    ggplot(na.omit(alpha.strategy.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.strategy.pc1 <-
    ggplot(na.omit(sigma.strategy.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.strategy.pc1 + alpha.strategy.pc1 + sigma.strategy.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_strategy_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.theta.pc1.", gsub(" ", ".", agg.strategy.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_strategy_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.alpha.pc1.", gsub(" ", ".", agg.strategy.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_strategy_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.sigma.pc1.", gsub(" ", ".", agg.strategy.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_strategy_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy."}

theta.strategy.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "strategy")
theta.strategy.plot.pc2$variable <- as.character(theta.strategy.plot.pc2$variable)
theta.strategy.plot.pc2 <- theta.strategy.plot.pc2[theta.strategy.plot.pc2$variable %in% paste0("theta", 1:length(states.strategy)), ]

alpha.strategy.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "strategy")
alpha.strategy.plot.pc2$variable <- as.character(alpha.strategy.plot.pc2$variable)
alpha.strategy.plot.pc2 <- alpha.strategy.plot.pc2[alpha.strategy.plot.pc2$variable %in% paste0("alpha", 1:length(states.strategy)), ]

sigma.strategy.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "strategy")
sigma.strategy.plot.pc2$variable <- as.character(sigma.strategy.plot.pc2$variable)
sigma.strategy.plot.pc2 <- sigma.strategy.plot.pc2[sigma.strategy.plot.pc2$variable %in% paste0("sigma", 1:length(states.strategy)), ]

theta.strategy.pc2 <-
    ggplot(na.omit(theta.strategy.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.strategy.pc2 <-
    ggplot(na.omit(alpha.strategy.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.strategy.pc2 <-
    ggplot(na.omit(sigma.strategy.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.strategy.pc2 + alpha.strategy.pc2 + sigma.strategy.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_strategy_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.theta.pc2.", gsub(" ", ".", agg.strategy.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_strategy_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.alpha.pc2.", gsub(" ", ".", agg.strategy.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_strategy_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.sigma.pc2.", gsub(" ", ".", agg.strategy.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_strategy_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy."}

theta.strategy.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "strategy")
theta.strategy.plot.pc3$variable <- as.character(theta.strategy.plot.pc3$variable)
theta.strategy.plot.pc3 <- theta.strategy.plot.pc3[theta.strategy.plot.pc3$variable %in% paste0("theta", 1:length(states.strategy)), ]

alpha.strategy.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "strategy")
alpha.strategy.plot.pc3$variable <- as.character(alpha.strategy.plot.pc3$variable)
alpha.strategy.plot.pc3 <- alpha.strategy.plot.pc3[alpha.strategy.plot.pc3$variable %in% paste0("alpha", 1:length(states.strategy)), ]

sigma.strategy.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "strategy")
sigma.strategy.plot.pc3$variable <- as.character(sigma.strategy.plot.pc3$variable)
sigma.strategy.plot.pc3 <- sigma.strategy.plot.pc3[sigma.strategy.plot.pc3$variable %in% paste0("sigma", 1:length(states.strategy)), ]

theta.strategy.pc3 <-
    ggplot(na.omit(theta.strategy.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.strategy.pc3 <-
    ggplot(na.omit(alpha.strategy.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.strategy.pc3 <-
    ggplot(na.omit(sigma.strategy.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.strategy) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.strategy.pc3 + alpha.strategy.pc3 + sigma.strategy.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_strategy_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.theta.pc3.", gsub(" ", ".", agg.strategy.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_strategy_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.alpha.pc3.", gsub(" ", ".", agg.strategy.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_strategy_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Strategy. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("strategy.diff.sigma.pc3.", gsub(" ", ".", agg.strategy.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Strategy. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.strategy, length(agg.strategy.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.strategy.diff.pc1$Group.1), c(1, rep(length(states.strategy), length(agg.strategy.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```







# Warts

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_warts_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts."}

theta.warts.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "warts")
theta.warts.plot.pc1$variable <- as.character(theta.warts.plot.pc1$variable)
theta.warts.plot.pc1 <- theta.warts.plot.pc1[theta.warts.plot.pc1$variable %in% paste0("theta", 1:length(states.warts)), ]

alpha.warts.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "warts")
alpha.warts.plot.pc1$variable <- as.character(alpha.warts.plot.pc1$variable)
alpha.warts.plot.pc1 <- alpha.warts.plot.pc1[alpha.warts.plot.pc1$variable %in% paste0("alpha", 1:length(states.warts)), ]

sigma.warts.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "warts")
sigma.warts.plot.pc1$variable <- as.character(sigma.warts.plot.pc1$variable)
sigma.warts.plot.pc1 <- sigma.warts.plot.pc1[sigma.warts.plot.pc1$variable %in% paste0("sigma", 1:length(states.warts)), ]

theta.warts.pc1 <-
    ggplot(na.omit(theta.warts.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.warts.pc1 <-
    ggplot(na.omit(alpha.warts.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.warts.pc1 <-
    ggplot(na.omit(sigma.warts.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.warts.pc1 + alpha.warts.pc1 + sigma.warts.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_warts_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.theta.pc1.", gsub(" ", ".", agg.warts.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_warts_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.alpha.pc1.", gsub(" ", ".", agg.warts.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_warts_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.sigma.pc1.", gsub(" ", ".", agg.warts.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_warts_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts."}

theta.warts.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "warts")
theta.warts.plot.pc2$variable <- as.character(theta.warts.plot.pc2$variable)
theta.warts.plot.pc2 <- theta.warts.plot.pc2[theta.warts.plot.pc2$variable %in% paste0("theta", 1:length(states.warts)), ]

alpha.warts.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "warts")
alpha.warts.plot.pc2$variable <- as.character(alpha.warts.plot.pc2$variable)
alpha.warts.plot.pc2 <- alpha.warts.plot.pc2[alpha.warts.plot.pc2$variable %in% paste0("alpha", 1:length(states.warts)), ]

sigma.warts.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "warts")
sigma.warts.plot.pc2$variable <- as.character(sigma.warts.plot.pc2$variable)
sigma.warts.plot.pc2 <- sigma.warts.plot.pc2[sigma.warts.plot.pc2$variable %in% paste0("sigma", 1:length(states.warts)), ]

theta.warts.pc2 <-
    ggplot(na.omit(theta.warts.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.warts.pc2 <-
    ggplot(na.omit(alpha.warts.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.warts.pc2 <-
    ggplot(na.omit(sigma.warts.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.warts.pc2 + alpha.warts.pc2 + sigma.warts.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_warts_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.theta.pc2.", gsub(" ", ".", agg.warts.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_warts_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.alpha.pc2.", gsub(" ", ".", agg.warts.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_warts_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.sigma.pc2.", gsub(" ", ".", agg.warts.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```

```{r pars_ouwie_warts_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts."}

theta.warts.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "warts")
theta.warts.plot.pc3$variable <- as.character(theta.warts.plot.pc3$variable)
theta.warts.plot.pc3 <- theta.warts.plot.pc3[theta.warts.plot.pc3$variable %in% paste0("theta", 1:length(states.warts)), ]

alpha.warts.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "warts")
alpha.warts.plot.pc3$variable <- as.character(alpha.warts.plot.pc3$variable)
alpha.warts.plot.pc3 <- alpha.warts.plot.pc3[alpha.warts.plot.pc3$variable %in% paste0("alpha", 1:length(states.warts)), ]

sigma.warts.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "warts")
sigma.warts.plot.pc3$variable <- as.character(sigma.warts.plot.pc3$variable)
sigma.warts.plot.pc3 <- sigma.warts.plot.pc3[sigma.warts.plot.pc3$variable %in% paste0("sigma", 1:length(states.warts)), ]

theta.warts.pc3 <-
    ggplot(na.omit(theta.warts.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

alpha.warts.pc3 <-
    ggplot(na.omit(alpha.warts.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank())

sigma.warts.pc3 <-
    ggplot(na.omit(sigma.warts.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.warts) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank())

(theta.warts.pc3 + alpha.warts.pc3 + sigma.warts.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_warts_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.theta.pc3.", gsub(" ", ".", agg.warts.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_warts_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.alpha.pc3.", gsub(" ", ".", agg.warts.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_warts_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Warts. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("warts.diff.sigma.pc3.", gsub(" ", ".", agg.warts.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Warts. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.warts, length(agg.warts.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.warts.diff.pc1$Group.1), c(1, rep(length(states.warts), length(agg.warts.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```




# Hole Diameter - Discrete

# PC1 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_holediam.disc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete."}

theta.holediam.disc.plot.pc1 <- subset(theta.plot.pc1, disc.trait == "holediam.disc")
theta.holediam.disc.plot.pc1$variable <- as.character(theta.holediam.disc.plot.pc1$variable)
theta.holediam.disc.plot.pc1 <- theta.holediam.disc.plot.pc1[theta.holediam.disc.plot.pc1$variable %in% paste0("theta", 1:length(states.holediam.disc)), ]

alpha.holediam.disc.plot.pc1 <- subset(alpha.plot.pc1, disc.trait == "holediam.disc")
alpha.holediam.disc.plot.pc1$variable <- as.character(alpha.holediam.disc.plot.pc1$variable)
alpha.holediam.disc.plot.pc1 <- alpha.holediam.disc.plot.pc1[alpha.holediam.disc.plot.pc1$variable %in% paste0("alpha", 1:length(states.holediam.disc)), ]

sigma.holediam.disc.plot.pc1 <- subset(sigma.plot.pc1, disc.trait == "holediam.disc")
sigma.holediam.disc.plot.pc1$variable <- as.character(sigma.holediam.disc.plot.pc1$variable)
sigma.holediam.disc.plot.pc1 <- sigma.holediam.disc.plot.pc1[sigma.holediam.disc.plot.pc1$variable %in% paste0("sigma", 1:length(states.holediam.disc)), ]

theta.holediam.disc.pc1 <-
    ggplot(na.omit(theta.holediam.disc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

alpha.holediam.disc.pc1 <-
    ggplot(na.omit(alpha.holediam.disc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

sigma.holediam.disc.pc1 <-
    ggplot(na.omit(sigma.holediam.disc.plot.pc1)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

(theta.holediam.disc.pc1 + alpha.holediam.disc.pc1 + sigma.holediam.disc.pc1) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC1 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_holediam.disc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.theta.pc1.", gsub(" ", ".", agg.holediam.disc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC1 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc1$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc1$Group.1)))))

```

```{r diffs_alpha_ouwie_holediam.disc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.alpha.pc1.", gsub(" ", ".", agg.holediam.disc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC1 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc1$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc1$Group.1)))))

```

```{r diffs_sigma_ouwie_holediam.disc_pc1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.sigma.pc1.", gsub(" ", ".", agg.holediam.disc.diff.pc1$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC1 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc1$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc1$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc1$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```








# PC2 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_holediam.disc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete."}

theta.holediam.disc.plot.pc2 <- subset(theta.plot.pc2, disc.trait == "holediam.disc")
theta.holediam.disc.plot.pc2$variable <- as.character(theta.holediam.disc.plot.pc2$variable)
theta.holediam.disc.plot.pc2 <- theta.holediam.disc.plot.pc2[theta.holediam.disc.plot.pc2$variable %in% paste0("theta", 1:length(states.holediam.disc)), ]

alpha.holediam.disc.plot.pc2 <- subset(alpha.plot.pc2, disc.trait == "holediam.disc")
alpha.holediam.disc.plot.pc2$variable <- as.character(alpha.holediam.disc.plot.pc2$variable)
alpha.holediam.disc.plot.pc2 <- alpha.holediam.disc.plot.pc2[alpha.holediam.disc.plot.pc2$variable %in% paste0("alpha", 1:length(states.holediam.disc)), ]

sigma.holediam.disc.plot.pc2 <- subset(sigma.plot.pc2, disc.trait == "holediam.disc")
sigma.holediam.disc.plot.pc2$variable <- as.character(sigma.holediam.disc.plot.pc2$variable)
sigma.holediam.disc.plot.pc2 <- sigma.holediam.disc.plot.pc2[sigma.holediam.disc.plot.pc2$variable %in% paste0("sigma", 1:length(states.holediam.disc)), ]

theta.holediam.disc.pc2 <-
    ggplot(na.omit(theta.holediam.disc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

alpha.holediam.disc.pc2 <-
    ggplot(na.omit(alpha.holediam.disc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

sigma.holediam.disc.pc2 <-
    ggplot(na.omit(sigma.holediam.disc.plot.pc2)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

(theta.holediam.disc.pc2 + alpha.holediam.disc.pc2 + sigma.holediam.disc.pc2) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC2 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_holediam.disc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.theta.pc2.", gsub(" ", ".", agg.holediam.disc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC2 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc2$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc2$Group.1)))))

```

```{r diffs_alpha_ouwie_holediam.disc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.alpha.pc2.", gsub(" ", ".", agg.holediam.disc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC2 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc2$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc2$Group.1)))))

```

```{r diffs_sigma_ouwie_holediam.disc_pc2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.sigma.pc2.", gsub(" ", ".", agg.holediam.disc.diff.pc2$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC2 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc2$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc2$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc2$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```







# PC3 - Parameters

```{r results = 'asis', echo = FALSE}

if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}

```


```{r pars_ouwie_holediam.disc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete."}

theta.holediam.disc.plot.pc3 <- subset(theta.plot.pc3, disc.trait == "holediam.disc")
theta.holediam.disc.plot.pc3$variable <- as.character(theta.holediam.disc.plot.pc3$variable)
theta.holediam.disc.plot.pc3 <- theta.holediam.disc.plot.pc3[theta.holediam.disc.plot.pc3$variable %in% paste0("theta", 1:length(states.holediam.disc)), ]

alpha.holediam.disc.plot.pc3 <- subset(alpha.plot.pc3, disc.trait == "holediam.disc")
alpha.holediam.disc.plot.pc3$variable <- as.character(alpha.holediam.disc.plot.pc3$variable)
alpha.holediam.disc.plot.pc3 <- alpha.holediam.disc.plot.pc3[alpha.holediam.disc.plot.pc3$variable %in% paste0("alpha", 1:length(states.holediam.disc)), ]

sigma.holediam.disc.plot.pc3 <- subset(sigma.plot.pc3, disc.trait == "holediam.disc")
sigma.holediam.disc.plot.pc3$variable <- as.character(sigma.holediam.disc.plot.pc3$variable)
sigma.holediam.disc.plot.pc3 <- sigma.holediam.disc.plot.pc3[sigma.holediam.disc.plot.pc3$variable %in% paste0("sigma", 1:length(states.holediam.disc)), ]

theta.holediam.disc.pc3 <-
    ggplot(na.omit(theta.holediam.disc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Theta") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

alpha.holediam.disc.pc3 <-
    ggplot(na.omit(alpha.holediam.disc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Alpha") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          strip.background.y = element_blank(),
          strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

sigma.holediam.disc.pc3 <-
    ggplot(na.omit(sigma.holediam.disc.plot.pc3)) +
    geom_jitter(aes(x = variable, y = value, colour = variable), alpha = 0.2, width = 0.1) +
    geom_boxplot(aes(x = variable, y = value, colour = variable), fill = NA, alpha = 0.1, lwd = 0.25, width = 0.5) +
    stat_summary(aes(x = variable, y = value), fun = "mean", geom = "point", size = 3, shape = 19) +
    scale_x_discrete(labels = states.holediam.disc) +
    theme_cowplot() +
    #coord_flip() +
    #ylim(-2, 6) +
    #coord_flip() +
    labs(x = "Discrete State", y = "Sigma") +
    facet_grid(trait ~ ., scales = "free_y") +
    theme(legend.position = "none",
          #strip.background.y = element_blank(),
          #strip.text.y = element_blank(),
          axis.title.x = element_blank(),
          axis.text.x = element_text(angle = 45, hjust = 1))

(theta.holediam.disc.pc3 + alpha.holediam.disc.pc3 + sigma.holediam.disc.pc3) +
    plot_annotation(tag_levels = 'A')

```

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```

## PC3 - Parameter differences

```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\begin{landscape}")
}
```

```{r diffs_theta_ouwie_holediam.disc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.theta.pc3.", gsub(" ", ".", agg.holediam.disc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Theta values for PC3 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc3$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc3$Group.1)))))

```

```{r diffs_alpha_ouwie_holediam.disc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.alpha.pc3.", gsub(" ", ".", agg.holediam.disc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Alpha values for PC3 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc3$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc3$Group.1)))))

```

```{r diffs_sigma_ouwie_holediam.disc_pc3, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 9, fig.cap = "Distribution of differences in Theta (A), Alpha (B) and Sigma (C) values for the OU-based models for each continuous trait in association with different states of Hole Diameter - Discrete. The differences are calculated always in relation to the first state."}

kable(x = apply(bind_cols(lapply(paste0("holediam.disc.diff.sigma.pc3.", gsub(" ", ".", agg.holediam.disc.diff.pc3$Group.1)), get)), c(1, 2), sig.formatter), format = "latex", caption = "Differences in Sigma values for PC3 analysis of Holediam.Disc. Each cell contains the number of replicas for which the row state was higher than the column state. Green cells highlight cases with more than 90 replicas, orange cells highlight cases between 75 and 90 replicas, and yellow cells highlight cases between 50 and 75 replicas.", escape = FALSE, digits = 3, col.names = rep(states.holediam.disc, length(agg.holediam.disc.diff.pc3$Group.1)), align = "c") %>%
    kable_styling(full_width = FALSE) %>%
    add_header_above(data.frame(c(" ", agg.holediam.disc.diff.pc3$Group.1), c(1, rep(length(states.holediam.disc), length(agg.holediam.disc.diff.pc3$Group.1)))))

```


```{r results = 'asis', echo = FALSE}
if (knitr::is_latex_output()) {
    cat("\\end{landscape}")
}
```
